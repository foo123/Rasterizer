/**
*   Rasterizer
*   rasterize, stroke and fill lines, rectangles, curves and paths
*
*   @version 1.0.0
*   https://github.com/foo123/Rasterizer
*
**/
!function(t,n,e){"use strict";"object"==typeof module&&module.exports?module.exports=e.call(t):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return e.call(t)}):n in t||(t[n]=e.call(t)||1)&&"function"==typeof define&&define.amd&&define(function(){return t[n]})}("undefined"!=typeof self?self:this,"Rasterizer",function(e){"use strict";var R=Object.defineProperty,n="prototype",rn=Math,ln=1/0,l=Number.EPSILON,r=rn.sqrt(2),P=isNaN,S=isFinite,D=function(n){return!P(n=+n)&&S(n)&&0<n},c=rn.PI,w=2*c,o=6,h=r,m=.5,J="undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:"undefined"!=typeof Uint8Array?Uint8Array:Array,L=[0,0,0,0],i=/[MLHVCSQTAZ]/gi,z=/-?(?:(?:\d+\.\d+)|(?:\.\d+)|(?:\d+))/g;function O(n,t,e,r){var i;if(!(this instanceof O))return new O(n,t,e,r);r=r||(e&&e.$target?O.getRGBAFrom(e.$target):function(n,t){return L}),i=new x(n,t,e,r),R(this,"width",{get:function(){return n},set:function(n){}}),R(this,"height",{get:function(){return t},set:function(n){}}),this.getContext=function(n){if("2d"===n)return i;V('Unsupported context "'+n+'"')}}function x(q,z,d,m){var l,u,t,e,o,a,f,s,c,h,g,p,w,y,x,T,C=this,i=null,v=null,r=function(){i={}},b=function(n){for(var t in i){var e=i[t],t=t.split(",");n(+t[0],+t[1],e)}i=null},A=function(n,t,e){var r;0<=n&&n<q&&0<=t&&t<z&&0<e&&0<y&&(n=String(n)+","+String(t),t=i[n]||0,r=v?v[n]||0:1,t<(e*=y*r))&&(i[n]=e)},k=function(n,t,e){var r="clear"===x?L:l(n,t),i=3<r.length?r[3]:1;d(n,t,r[0],r[1],r[2],i*e,x)},I=function(n,t,e){var r="clear"===x?L:u(n,t),i=3<r.length?r[3]:1;d(n,t,r[0],r[1],r[2],i*e,x)},n=function(n){l=O.getRGBAFrom([0,0,0,1]),u=O.getRGBAFrom([0,0,0,1]),v=i=null,f="butt",s="miter",c=10,h=1,g=[],p=0,w=G.EYE(),y=1,x="source-over",t=[],T=new E(w),n||C.clearRect(0,0,q,z)};R(C,"strokeStyle",{get:function(){return""},set:function(n){l=O.getRGBAFrom(n)}}),R(C,"fillStyle",{get:function(){return""},set:function(n){u=O.getRGBAFrom(n)}}),R(C,"lineWidth",{get:function(){return h},set:function(n){D(n=+n)&&(h=n)}}),R(C,"lineCap",{get:function(){return f},set:function(n){n=String(n).toLowerCase(),-1!==["butt","square","round"].indexOf(n)&&(f=n)}}),R(C,"lineJoin",{get:function(){return s},set:function(n){n=String(n).toLowerCase(),-1!==["miter","bevel","round"].indexOf(n)&&(s=n)}}),R(C,"miterLimit",{get:function(){return c},set:function(n){!P(n=+n)&&S(n)&&0<=n&&(c=n)}}),R(C,"lineDashOffset",{get:function(){return p},set:function(n){!P(n=+n)&&S(n)&&(p=n)}}),R(C,"lineDash",{get:function(){return g.slice()},set:function(n){(n=1&(n=[].concat(n)).length?n.concat(n):n).filter(D).length===n.length&&(g=n)}}),C.getLineDash=function(){return C.lineDash},C.setLineDash=function(n){C.lineDash=n},R(C,"globalAlpha",{get:function(){return y},set:function(n){!P(n=+n)&&0<=n&&n<=1&&(y=n)}}),R(C,"globalCompositeOperation",{get:function(){return x},set:function(n){x=String(n)}}),C.save=function(){(t=t||[]).push([l,u,v,f,s,c,h,g,p,w,y,x])},C.restore=function(){var n;t&&t.length&&(n=t.pop(),l=n[0],u=n[1],v=n[2],f=n[3],s=n[4],c=n[5],h=n[6],g=n[7],p=n[8],T.transform=w=n[9],y=n[10],x=n[11])},C.reset=function(){n()},C.scale=function(n,t){T.transform=w=w.mul(G.scale(n,t))},C.rotate=function(n){T.transform=w=w.mul(G.rotate(n||0))},C.translate=function(n,t){T.transform=w=w.mul(G.translate(n||0,t||0))},C.transform=function(n,t,e,r,i,l){T.transform=w=w.mul(new G(n,e,i,t,r,l))},C.getTransform=function(){return w.clone()},C.setTransform=function(n,t,e,r,i,l){1<arguments.length?w=new G(n,e,i,t,r,l):n&&null!=n.a&&null!=n.f&&(w=new G(n.a,n.c,n.e,n.b,n.d,n.f)),T.transform=w},C.resetTransform=function(){T.transform=w=G.EYE()},C.beginPath=function(){T=new E(w)},C.closePath=function(){T.closePath()},C.moveTo=function(n,t){T.moveTo(n,t)},C.lineTo=function(n,t){T.lineTo(n,t)},C.rect=function(n,t,e,r){T.rect(n,t,e,r)},C.roundRect=function(n,t,e,r){T.roundRect.apply(T,arguments)},C.arc=function(n,t,e,r,i,l){T.arc(n,t,e,r,i,l)},C.ellipse=function(n,t,e,r,i,l,u,o){T.ellipse(n,t,e,r,i,l,u,o)},C.arcTo=function(n,t,e,r,i){T.arcTo(n,t,e,r,i)},C.quadraticCurveTo=function(n,t,e,r){T.quadraticCurveTo(n,t,e,r)},C.bezierCurveTo=function(n,t,e,r,i,l){T.bezierCurveTo(n,t,e,r,i,l)},C.clearRect=function(n,t,e,r){var i=x,l=y;x="clear",y=1,C.fill(new E(w).rect(n,t,e,r),"evenodd"),x=i,y=l},C.strokeRect=function(n,t,e,r){0<h&&C.stroke(new E(w).rect(n,t,e,r))},C.fillRect=function(n,t,e,r){C.fill(new E(w).rect(n,t,e,r),"evenodd")},C.stroke=function(n){var t,e;0<h&&(e=(n=n||T).transform,t=rn.abs(e.sx),e=rn.abs(e.sy),r(),j(A,n,h,g,p,f,s,c,t,e,0,0,q-1,z-1),b(k))},e=function(n,t){var e=q-1,r=z-1,i=(j(A,n,.5,[],0,"butt","bevel",0,1,1,0,0,e,r),A),l=0,u=0,o=e,e=r,a=n._sd;if(a.length){var f,s,c,h,m,g,d,p,y,x,v,b,w,C,T=a.length,k=new Array(T),I=a.ymin,R=a.ymax,P=0,S="evenodd"===t;for(I=rn.max(u,rn.round(I)),R=rn.min(e,rn.round(R));I<=R;++I){for(;P<T&&a[P][3]<I;)++P;if(T<=P)break;if((c=a[P])[1]>I)I=rn.floor(c[1]);else{for(x=c[0],v=c[2],m=c[1],g=c[3],y=Y(m,g)?(b=!1,p=rn.min(x,v),rn.max(x,v)):p=b=(v-x)*(I-m)/(g-m)+x,c[8]=b,c[9]=0,k[0]=c,f=P+(s=1);f<T&&a[f][1]<=I;++f)(c=a[f])[3]>=I&&(x=c[0],v=c[2],m=c[1],g=c[3],y=Y(m,g)?(b=!1,p=rn.min(p,x,v),rn.max(y,x,v)):(b=(v-x)*(I-m)/(g-m)+x,p=rn.min(p,b),rn.max(y,b)),c[8]=b,c[9]=0,k[s++]=c);if(h=$(k,s),!(s<h+2||(p=rn.max(l,rn.round(p+.5)),(y=rn.min(o,rn.round(y-.5)))<p)))if(S)for(d=p;d<=y;++d){for(C=w=!1,f=0;f<s;++f)(c=k[f])[9]||!1!==(b=c[8])&&(b<d&&(w=!w),d<b)&&(C=!C);w&&C&&i(d,I,1)}else for(d=p;d<=y;++d){for(f=C=w=0;f<s;++f)(c=k[f])[9]||!1!==(b=c[8])&&(b<d||d<b)&&(h=H(d,I,c[c[4]<0?2:0],c[c[4]<0?3:1],c[c[4]<0?0:2],c[c[4]<0?1:3]),b<d&&(w+=h),d<b)&&(C+=h);w&&C&&i(d,I,1)}}}}},C.fill=function(n,t){!arguments.length||null==n&&null==t?(n=T,t="nonzero"):1!==arguments.length&&null!=t||(n instanceof E?t="nonzero":(t=n,n=T)),t=String(t||"nonzero").toLowerCase(),r(),e(n=n||T,t="evenodd"!==t?"nonzero":t),b(I)},C.clip=function(n,t){!arguments.length||null==n&&null==t?(n=T,t="nonzero"):1!==arguments.length&&null!=t||(n instanceof E?t="nonzero":(t=n,n=T)),"evenodd"!==(t=String(t||"nonzero").toLowerCase())&&(t="nonzero"),(n=n||T)===T&&(T=new E(w)),r(),e(n,t),v=i,i=null},C.isPointInStroke=function(n,r,i){arguments.length<3&&(i=r,r=n,n=T),r=r||0,i=i||0,n=n||T,r=rn.round(r),i=rn.round(i);var l=String(r)+","+String(i),u=!1;return j(function(n,t,e){r===n&&i===t&&0<(e*=v?v[l]||0:1)&&(u=!0)},n,h,g,p,f,s,c,n.transform.sx,n.transform.sy,null,null,null,null),u},C.isPointInPath=function(n,t,e,r){n instanceof E||(r=e,e=t,t=n,n=T),"evenodd"!==(r=String(r||"nonzero").toLowerCase())&&(r="nonzero");var i=t||0,l=e||0,t=r,u=(e=n||T)._sd;if(!(!u.length||l<u.ymin||l>u.ymax)){for(var o,a,f,s,c,h,m,g,d,p,y,x,v,b=u.length,w=new Array(b),C=0,e="evenodd"===t;C<b&&u[C][3]<l;)++C;if(!(b<=C||(f=u[C])[1]>l)){for(d=f[0],p=f[2],c=f[1],h=f[3],g=Y(c,h)?(y=!1,m=rn.min(d,p),rn.max(d,p)):m=y=(p-d)*(l-c)/(h-c)+d,f[8]=y,f[9]=0,w[0]=f,o=C+(a=1);o<b&&u[o][1]<=l;++o)(f=u[o])[3]>=l&&(d=f[0],p=f[2],c=f[1],h=f[3],g=Y(c,h)?(y=!1,m=rn.min(m,d,p),rn.max(g,d,p)):(y=(p-d)*(l-c)/(h-c)+d,m=rn.min(m,y),rn.max(g,y)),f[8]=y,f[9]=0,w[a++]=f);if(s=$(w,a),a<s+2)return!1!==w[0][8]&&B(i,w[0][8]);if(!(g<m||i<m||g<i)){if(e)for(v=x=!1,o=0;o<a;++o)(f=w[o])[9]||!1!==(y=f[8])&&(y<=i&&(x=!x),i<=y)&&(v=!v);else for(o=v=x=0;o<a;++o)(f=w[o])[9]||!1!==(y=f[8])&&(y<i||i<y)&&(s=H(i,l,f[f[4]<0?2:0],f[f[4]<0?3:1],f[f[4]<0?0:2],f[f[4]<0?1:3]),y<=i&&(x+=s),i<=y)&&(v+=s);if(x&&v)return!0}}}return!1},o=function(n,t,e,r,i,l,u){if(r=rn.min(r,t-1),i=rn.min(i,e-1),l=rn.min(l,t-1),u=rn.min(u,e-1),l<r||u<i)return new J(0);var o,a,f,s,c,h=new J((l-r+1)*(u-i+1)<<2);if(n)for(a=r,f=i,s=0;f<=u&&!(l<a&&(a=r,u<++f));s+=4,++a)h[s]=n[c=f*t+a<<2],h[s+1]=n[1+c],h[s+2]=n[2+c],h[s+3]=n[3+c];else for(a=r,f=i,s=0;f<=u&&!(l<a&&(a=r,u<++f));s+=4,++a)o=m(a,f),h[s]=U(o[0],0,255),h[s+1]=U(o[1],0,255),h[s+2]=U(o[2],0,255),h[s+3]=U(rn.round(255*o[3]),0,255);return h},a=function(n,t,e,r,i,l,u,o,a,f,s,c){var h,m,g;for(u=rn.min(u,i-1),o=rn.min(o,l-1),s=rn.min(s,t-1),c=rn.min(c,e-1),a=rn.min(a,i-1),f=rn.min(f,l-1),s-=u,c-=o,m=u,g=o;g<=f&&!(a<m&&(m=u,f<++g));++m)e<=g+c||t<=m+s||d(m+s,g+c,r[h=g*i+m<<2],r[1+h],r[2+h],r[3+h]/255,"copy")},C.drawImage=function(n,o,a,f,s,c,h,m,g){n&&n.data||V("Invalid image data in drawImage");var d,p,y=n.width,x=n.height,v=n.data,n=arguments.length,t=u,b=y<<2;y&&x||V("Invalid image data in drawImage"),o=o||0,a=a||0,n<4&&(f=y,s=x),n<6&&(c=o,h=a,m=f,g=s),d=w.inv(),p=[0,0],u=function(n,t){d.transform(n,t,p),n=o+(p[0]-c)*f/m,t=a+(p[1]-h)*s/g;var e=n-rn.floor(n),r=t-rn.floor(t),i=(1-e)*(1-r),l=e*(1-r),u=r*(1-e),e=e*r;return n=rn.floor(n),t=rn.floor(t),0<=n&&n<y&&0<=t&&t<x?[U(rn.round(v[r=n+y*t<<2]*i+(n+1<y?v[4+r]:0)*l+(t+1<x?v[r+b]:0)*u+(n+1<y&&t+1<x?v[4+r+b]:0)*e),0,255),U(rn.round(v[1+r]*i+(n+1<y?v[5+r]:0)*l+(t+1<x?v[r+b+1]:0)*u+(n+1<y&&t+1<x?v[5+r+b]:0)*e),0,255),U(rn.round(v[2+r]*i+(n+1<y?v[6+r]:0)*l+(t+1<x?v[r+b+2]:0)*u+(n+1<y&&t+1<x?v[6+r+b]:0)*e),0,255),U(rn.round(v[3+r]*i+(n+1<y?v[7+r]:0)*l+(t+1<x?v[r+b+3]:0)*u+(n+1<y&&t+1<x?v[7+r+b]:0)*e),0,255)/255]:L},C.fillRect(c,h,m,g),u=t},C.getImageData=function(n,t,e,r){var i=q,l=z;return null==t&&(t=0),null==e&&(e=i),null==r&&(r=l),n=rn.max(0,rn.min(n=null==n?0:n,i-1)),t=rn.max(0,rn.min(t,l-1)),e=rn.min(n+e-1,i-1),r=rn.min(t+r-1,l-1),{data:o(null,i,l,n,t,e,r),width:e-n+1,height:r-t+1}},C.putImageData=function(n,t,e){n&&n.data||V("Invalid image data in putImageData");var r=n.width,i=n.height;a(0,q,z,n.data,r,i,0,0,r-1,i-1,t=null==t?0:t,e=null==e?0:e)},n(!0)}function E(n,c){var t,s,e,h,m,g,d,p,y,x=this,f=!0,v=[],b=null;R(x,"transform",{get:function(){return c.clone()},set:function(n){c=n}}),R(x,"_d",{get:function(){return v},set:function(n){}}),R(x,"_sd",{get:function(){return b=b||X(v)},set:function(n){}}),x.moveTo=function(n,t){n=T([n,t],c);return n&&(v.push(n),f=!1),x},x.closePath=function(){var n,t,e,r,i,l;return v.length&&2<v[v.length-1].length&&(n=+v[v.length-1][0],t=v[v.length-1][1],e=+v[v.length-1][2],r=v[v.length-1][3],i=+v[v.length-1][v[v.length-1].length-2],l=v[v.length-1][v[v.length-1].length-1],B(n,i,1e-6)&&B(t,l,1e-6)?v[v.length-1][v[v.length-1].length-2]=new C(i,{join:[e,r]}):v[v.length-1].push(new C(n,{join:[e,r]}),t),v.push([n,t]),f=!1,b=null),x},x.lineTo=function(n,t){n=T([n,t],c);return n&&(f?(v.push(n),f=!1):(v[v.length-1].push(n[0],n[1]),b=null)),x},x.rect=function(n,t,e,r){e=T([n,t,n+e,t,n+e,t+r,n,t+r],c);return e?(e[0]=new C(+e[0],{lineCap:"butt",lineJoin:"miter"}),v.length&&v[v.length-1].length<=2?v[v.length-1]=e:v.push(e),b=null,x.closePath()):x},x.roundRect=function(n,t,e,r){var i,l,u,o,a,f,s=T([n,t,e,r]);return s?(((f=(arguments[4]&&arguments[4].push?arguments[4]:[].slice.call(arguments,4)).filter(function(n){return 0<n})).length<1||4<f.length)&&V("Invalid radii in roundRect"),4===f.length?(i=f[0],l=f[1],u=f[2],o=f[3]):3===f.length?(i=f[0],l=f[1],o=f[1],u=f[2]):o=2===f.length?(i=f[0],u=f[0],l=f[1],f[1]):(i=f[0],l=f[0],u=f[0],f[0]),e<0&&(n+=e,e=-e,a=i,i=l,l=a,a=o,o=u,u=a),r<0&&(t+=r,r=-r,a=i,i=o,o=a,a=l,l=u,u=a),(f=rn.min(e/(i+l),r/(l+u),e/(u+o),r/(i+o)))<1&&(i*=f,l*=f,o*=f,u*=f),k(s=[],n+i,t,c),k(s,n+e-l,t,c),I(s,n+e-l,t,n+e,t,n+e,t+l,l,c),k(s,n+e,t+r-u,c),I(s,n+e,t+r-u,n+e,t+r,n+e-u,t+r,u,c),k(s,n+o,t+r,c),I(s,n+o,t+r,n,t+r,n,t+r-o,o,c),k(s,n,t+i,c),I(s,n,t+i,n,t,n+i,t,i,c),s[0]=new C(+s[0],{lineCap:"butt",lineJoin:"bevel"}),v.push(s),b=null,x.closePath()):x},x.arc=function(n,t,e,r,i,l){var u=T([n,t,e,r,i]);return u&&(e<0&&V("Negative radius in arc"),(u=_(n,t,e,e,0,r,i,l,c))[0]=new C(+u[0],{type:"arc",lineCap:!0,lineJoin:"bevel"}),u[u.length-2]=new C(+u[u.length-2],{type:"arc",lineCap:!0,lineJoin:!0}),f?(v.push(u),f=!1):v[v.length-1].push.apply(v[v.length-1],u),b=null),x},x.ellipse=function(n,t,e,r,i,l,u,o){var a=T([n,t,e,r,i,l,u]);return a&&((e<0||r<0)&&V("Negative radius in ellipse"),(a=_(n,t,e,r,i,l,u,o,c))[0]=new C(+a[0],{type:"arc",lineCap:!0,lineJoin:"bevel"}),a[a.length-2]=new C(+a[a.length-2],{type:"arc",lineCap:!0,lineJoin:!0}),f?(v.push(a),f=!1):v[v.length-1].push.apply(v[v.length-1],a),b=null),x},x.arcTo=function(n,t,e,r,i){n=T([n,t,e,r,i]);return n&&(i<0&&V("Negative radius in arcTo"),f&&(v.push(c.transform(n[0],n[1])),f=!1),(n=A((t=c.inv().transform(+v[v.length-1][v[v.length-1].length-2],v[v.length-1][v[v.length-1].length-1]))[0],t[1],n[0],n[1],n[2],n[3],i,c))[0]=new C(+n[0],{type:"arc",lineCap:!0,lineJoin:"bevel"}),n[n.length-2]=new C(+n[n.length-2],{type:"arc",lineCap:!0,lineJoin:!0}),v[v.length-1].push.apply(v[v.length-1],n),b=null),x},x.quadraticCurveTo=function(n,t,e,r){n=T([n,t,e,r],c);return n&&(f&&(v.push([n[0],n[1]]),f=!1),t=v[v.length-1].pop(),(n=u([+v[v.length-1].pop(),t,n[0],n[1],n[2],n[3]],c))[0]=new C(+n[0],{type:"bezier",lineCap:!0,lineJoin:"bevel"}),n[n.length-2]=new C(+n[n.length-2],{type:"bezier",lineCap:!0,lineJoin:!0}),v[v.length-1].push.apply(v[v.length-1],n),b=null),x},x.bezierCurveTo=function(n,t,e,r,i,l){n=T([n,t,e,r,i,l],c);return n&&(f&&(v.push([n[0],n[1]]),f=!1),t=v[v.length-1].pop(),(n=u([+v[v.length-1].pop(),t,n[0],n[1],n[2],n[3],n[4],n[5]],c))[0]=new C(+n[0],{type:"bezier",lineCap:!0,lineJoin:"bevel"}),n[n.length-2]=new C(+n[n.length-2],{type:"bezier",lineCap:!0,lineJoin:!0}),v[v.length-1].push.apply(v[v.length-1],n),b=null),x},x.addPath=function(n){return n instanceof E&&(t(n),b=null),x},x.dispose=function(){b=v=null},t=function(n){var e;n._d.reduce(function(n,t){return t&&t.length&&2<t.length&&(e=[+t[t.length-2],t[t.length-1]],n.push(t.slice())),n},v),f=!e||(v.push(e),!1)},1===arguments.length&&(n instanceof G?(c=n,n=null):c=null),c=(c=c instanceof G?c:null)||G.EYE(),n&&(n instanceof E?t(n):(n=n,s=x,e=K(String(n)).match(i),h=n.split(i),d=null,y=p=!(g=[(m=[0,0])[0],m[1]]),e&&e.forEach(function(n,t){var e,r,i,l,u,o,a=n===n.toLowerCase(),f=(K(h[t+1]||"").match(z)||[]).map(Z);switch(n.toUpperCase()){case"M":for(o=!1;2<=f.length;)o?(e=[m[0],m[1]],r=[(a?e[0]:0)+f.shift(),(a?e[1]:0)+f.shift()],m[0]=r[0],m[1]=r[1],s.lineTo(m[0],m[1]),p=!0):(m[0]=(a?m[0]:0)+f.shift(),m[1]=(a?m[1]:0)+f.shift(),g=[m[0],m[1]],s.moveTo(m[0],m[1]),y=!0),o=!0;d=null;break;case"H":for(p=y||p;1<=f.length;)e=[m[0],m[1]],r=[(a?e[0]:0)+f.shift(),e[1]],m[0]=r[0],m[1]=r[1],s.lineTo(m[0],m[1]),y&&(p=!0),y=!0;d=null;break;case"V":for(p=y||p;1<=f.length;)r=[(e=[m[0],m[1]])[0],(a?e[1]:0)+f.shift()],m[0]=r[0],m[1]=r[1],s.lineTo(m[0],m[1]),y&&(p=!0),y=!0;d=null;break;case"L":for(p=y||p;2<=f.length;)e=[m[0],m[1]],r=[(a?e[0]:0)+f.shift(),(a?e[1]:0)+f.shift()],m[0]=r[0],m[1]=r[1],s.lineTo(m[0],m[1]),y&&(p=!0),y=!0;d=null;break;case"A":for(y=p=!0;7<=f.length;)u={start:null,end:null,radiusX:f.shift(),radiusY:f.shift(),angle:f.shift(),largeArc:f.shift(),sweep:f.shift()},e=[m[0],m[1]],r=[(a?e[0]:0)+f.shift(),(a?e[1]:0)+f.shift()],m[0]=r[0],m[1]=r[1],u.start=e,u.end=r,s.ellipse.apply(s,function(n,t,e,r,i,l,u,o,a){var f=a?rn.cos(a):1,s=a?rn.sin(a):0,c=f*(n-e)/2+s*(t-r)/2,h=-s*(n-e)/2+f*(t-r)/2,m=c*c,g=h*h,d=u*u,p=o*o,y=m/d+g/p;1<y&&(y=rn.sqrt(y),d=(u*=y)*u,p=(o*=y)*o);y=rn.sqrt(rn.abs((d*p-d*g-p*m)/(d*g+p*m)))*(i===l?-1:1),d=y*u*h/o,g=-y*o*c/u,p=f*d-s*g+(n+e)/2,m=s*d+f*g+(t+r)/2,i=Q(W(1,0,(c-d)/u,(h-g)/o)),y=W((c-d)/u,(h-g)/o,(-c-d)/u,(-h-g)/o);y-=rn.floor(y/w)*w,!l&&0<y&&(y-=w);l&&y<0&&(y+=w);return[p,m,u,o,a,i,i+y,!l]}(u.start[0],u.start[1],u.end[0],u.end[1],u.largeArc,u.sweep,u.radiusX,u.radiusY,u.angle));d=null;break;case"Q":for(y=p=!0;4<=f.length;)e=[m[0],m[1]],r=[(a?e[0]:0)+f.shift(),(a?e[1]:0)+f.shift()],i=[(a?e[0]:0)+f.shift(),(a?e[1]:0)+f.shift()],m[0]=i[0],m[1]=i[1],s.quadraticCurveTo(r[0],r[1],i[0],i[1]),d=["Q",e,r,i];break;case"T":for(y=p=!0;2<=f.length;)e=[m[0],m[1]],i=[(a?e[0]:0)+f.shift(),(a?e[1]:0)+f.shift()],r=d&&"Q"===d[0]?[2*e[0]-d[2][0],2*e[1]-d[2][1]]:[e[0],e[1]],m[0]=i[0],m[1]=i[1],s.quadraticCurveTo(r[0],r[1],i[0],i[1]),d=["Q",e,r,i];break;case"C":for(y=p=!0;6<=f.length;)e=[m[0],m[1]],r=[(a?e[0]:0)+f.shift(),(a?e[1]:0)+f.shift()],i=[(a?e[0]:0)+f.shift(),(a?e[1]:0)+f.shift()],l=[(a?e[0]:0)+f.shift(),(a?e[1]:0)+f.shift()],m[0]=l[0],m[1]=l[1],s.bezierCurveTo(r[0],r[1],i[0],i[1],l[0],l[1]),d=["C",e,r,i,l];break;case"S":for(y=p=!0;4<=f.length;)e=[m[0],m[1]],i=[(a?e[0]:0)+f.shift(),(a?e[1]:0)+f.shift()],l=[(a?e[0]:0)+f.shift(),(a?e[1]:0)+f.shift()],r=d&&"C"===d[0]?[2*e[0]-d[3][0],2*e[1]-d[3][1]]:[e[0],e[1]],m[0]=l[0],m[1]=l[1],s.bezierCurveTo(r[0],r[1],i[0],i[1],l[0],l[1]),d=["C",e,r,i,l];break;case"Z":e=[m[0],m[1]],r=[g[0],g[1]],m[0]=r[0],m[1]=r[1],g=[m[0],m[1]],s.closePath(),y=p=!1,d=null}}),p&&s.moveTo(m[0],m[1])))}function G(n,t,e,r,i,l){var u=this,o=1,a=1;arguments.length&&(u.m11=n,u.m12=t,u.m13=e,u.m21=r,u.m22=i,u.m23=l),R(u,"a",{get:function(){return u.m11},set:function(n){u.m11=o=n}}),R(u,"c",{get:function(){return u.m12},set:function(n){u.m12=n}}),R(u,"e",{get:function(){return u.m13},set:function(n){u.m13=n}}),R(u,"b",{get:function(){return u.m21},set:function(n){u.m21=n}}),R(u,"d",{get:function(){return u.m22},set:function(n){u.m22=a=n}}),R(u,"f",{get:function(){return u.m23},set:function(n){u.m23=n}}),R(u,"is2D",{get:function(){return!0},set:function(n){}}),R(u,"isIdentity",{get:function(){return Y(u.m11,1)&&Y(u.m12,0)&&Y(u.m13,0)&&Y(u.m21,0)&&Y(u.m22,1)&&Y(u.m23,0)},set:function(n){}}),R(u,"sx",{get:function(){return o},set:function(n){o*=n}}),R(u,"sy",{get:function(){return a},set:function(n){a*=n}})}function C(n,t){this.value=n,this.params=t||null}function T(n,t){for(var e,r=0,i=n.length;r<i;++r)if(P(n[r])||!S(n[r]))return null;if(t)for(e=[0,0],r=0;r<i;r+=2)t.transform(n[r],n[r+1],e),n[r]=e[0],n[r+1]=e[1];return n}function k(n,t,e,r){r=r?r.transform(t,e):[t,e];n.push(r[0],r[1])}function I(n,t,e,r,i,l,u,o,a){n.push.apply(n,A(t,e,r,i,l,u,o,a))}function un(){return this.v}function fn(n,t,e,r,i,l){var u,o,a,f,s=t.length;if((e=U(e,0,l-1))+1<l)for(f=i.l||0,o=i.i||0;o<s;++o){if(0<t[o]&&f+t[o]>e)return a=o<<1,r.i=o,Y(u=U((e-(r.l=f))/t[o],0,1),0)?(r.x=n[a+0],r.y=n[a+1]):Y(u,1)?(r.x=n[a+2],r.y=n[a+3]):(r.x=+n[a]+(+n[a+2]-n[a])*u,r.y=+n[a+1]+(+n[a+3]-n[a+1])*u),void(r.y={dx:+n[a+2]-n[a+0],dy:+n[a+3]-n[a+1],v:r.y,valueOf:un});f+=t[o]}a=(o=s-1)<<1,r.i=o,r.l=l,r.x=n[a+2],r.y={dx:+n[a+2]-n[a+0],dy:+n[a+3]-n[a+1],v:n[a+3],valueOf:un}}function sn(n,t,e,r,i,l,u,o,a,f,s,c,h,m,g,d,p,y,x){var v,b,w,C,T;return 0===o&&0===a?N(n,t,e,r,i,l,u,c,h,m,g,d,!0,!0,x):0===l&&0===u&&null!=p?N(n,t-o,e-(p*y<0?1:-1)*a,r+o,i+(p*y<0?1:-1)*a,2*o,2*a,1,h,m,g,d,!1,!1,x):(n=n,t=t,e=e,r=r,i=i,o=o,a=a,f=f,s=s,c=c,h=h,m=m,g=g,d=d,p=p,y=y,x=x,T=an(l=l,u=u),T=null!=x&&x<1&&0<x?x:(T<1?T:1)||1,r<t&&(x=t,t=r,r=x,x=e,e=i,i=x,x=f,f=s,s=x),x=i<e?-1:1,!Y(l,0)||null!=p&&0!==p?!Y(u,0)||null!=y&&0!==y?("square"===f&&(t-=+a,e-=x*o),"square"===s&&(r+=+a,i+=x*o),p=t-(l=+o),y=e+(u=x*a),v=t+l,w=e-u,b=r-l,C=i+u,l=r+l,u=i-u,"round"!==f&&"round"!==s||(c=an(o,a)),"round"===f?F(n,p,y,v,w,(p-+a+v-+a)/2,(y-x*o+w-x*o)/2,c,h,m,g,d,T):N(n,p,y,v,w,null,null,T,h,m,g,d),N(n,v,w,l,u,null,null,T,h,m,g,d),"round"===s?F(n,l,u,b,C,(+a+b+l+ +a)/2,(C+x*o+u+x*o)/2,c,h,m,g,d,T):N(n,l,u,b,C,null,null,T,h,m,g,d),N(n,b,C,p,y,null,null,T,h,m,g,d),function(n,t,e,r,i,l,u,o,a,f,s,c,h,m){var g,d,p,y,x,v,b,w,C=rn.min(e,i,u,a),T=rn.max(e,i,u,a),k=rn.min(t,r,l,o),I=rn.max(t,r,l,o),R=null!=f;if(R&&(T<s||h<C||I<f||c<k))return;null==m&&(m=1);if(Y(C,T))return C=rn.round(C),k=rn.round(k),I=rn.round(I),q(n,k,C,I,C,f,s,c,h,m);C=rn.round(C),T=rn.round(T),R&&(C=rn.max(s,C),T=rn.min(h,T));if(!(T<C))for((x=[i<e?[r,i,t,e]:[t,e,r,i],u<i?[l,u,r,i]:[r,i,l,u],a<u?[o,a,l,u]:[l,u,o,a],e<a?[t,e,o,a]:[o,a,t,e]])[1][1]<x[0][1]&&(v=x[0],x[0]=x[1],x[1]=v),x[3][1]<x[2][1]&&(v=x[2],x[2]=x[3],x[3]=v),x[2][1]<x[0][1]&&(v=x[0],x[0]=x[2],x[2]=v),x[3][1]<x[1][1]&&(v=x[1],x[1]=x[3],x[3]=v),x[2][1]<x[1][1]&&(v=x[2],x[2]=x[1],x[1]=v),b=0;C<=T;++C){for(;b<4&&x[b][3]<C;)++b;if(4<=b)return;for(I=-(k=ln),w=b;w<4;++w)p=x[w][0],g=x[w][1],y=x[w][2],d=x[w][3],g<=C&&C<=d&&(I=Y(g,d)?(k=rn.min(k,p,y),rn.max(I,p,y)):(y=(y-p)*(C-g)/(d-g)+p,k=rn.min(k,y),rn.max(I,y)));if(I-k<1)(!R||f<=k&&k<=c)&&n(rn.round(k),C,1);else for(k=rn.round(k+.5),I=rn.round(I-.5),R&&(k=rn.max(f,k),I=rn.min(c,I));k<=I;++k)n(k,C,m)}}(n,p,y,v,w,l,u,b,C,h,m,g,d,T)):("square"===f&&(t-=+a),"square"===s&&(r+=+a),"round"===f&&F(n,t,e-a,t,e+a,t-a,e,a,h,m,g,d,T),"round"===s&&F(n,r,i-a,r,i+a,r+a,i,a,h,m,g,d,T),q(n,rn.round(t),rn.round(e-a),rn.round(r),rn.round(e+a),h,m,g,d,T)):("square"===f&&(e-=x*o),"square"===s&&(i+=x*o),"round"===f&&F(n,t-o,e,t+o,e,t,e-x*o,o,h,m,g,d,T),"round"===s&&F(n,r-o,i,r+o,i,r,i+x*o,o,h,m,g,d,T),q(n,rn.round(t-o),rn.round(e),rn.round(t+o),rn.round(i),h,m,g,d,T)),T)}function on(n,t,e,r,i,l,u){var n=rn.max(0,(n-1)/2),o=1===r?0:r/2,a=1===i?0:i/2;return null!=l&&(t=rn.abs(l),e=rn.abs(u)),r*n+o<.5&&i*n+a<.5?[0,0]:Y(t,0)?[r*n+o,0]:Y(e,0)?[0,i*n+a]:[(r*n+o)*e/(l=an(t,e)),(i*n+a)*t/l]}function q(n,t,e,r,i,l,u,o,a,f){var s,c;if(r<t&&(s=t,t=r,r=s),i<e&&(c=e,e=i,i=c),null!=l){if(r<l||o<t||i<u||a<e)return;t=rn.max(t,l),e=rn.max(e,u),r=rn.min(r,o),i=rn.min(i,a)}if(null==f&&(f=1),e===i)for(s=t;s<=r;++s)n(s,e,f);else if(t===r)for(c=e;c<=i;++c)n(t,c,f);else for(c=e;c<=i;++c)for(s=t;s<=r;++s)n(s,c,f)}function M(n,t,e,r,i,l,u,o,a,f,s,c){var h,m,g,d,p,y,x,v,b,w,C,T,k,I,R=null!=o;if(!R||!(rn.max(t,r,l)<o||rn.min(t,r,l)>f||rn.max(e,i,u)<a||rn.min(e,i,u)>s)){if(null==c&&(c=1),i<e&&(g=e,e=i,i=g,g=t,t=r,r=g),u<e&&(g=e,e=u,u=g,g=t,t=l,l=g),u<i&&(g=i,i=u,u=g,g=r,r=l,l=g),Y(w=u-e,0))return d=rn.round(e),q(n,h=rn.round(rn.min(t,r,l)),d,m=rn.round(rn.max(t,r,l)),d,o,a,f,s,c);for(T=u-i,x=l-t,v=r-t,b=l-r,k=Y(C=i-e,0),I=Y(T,0),d=rn.round(e+.5),p=i,y=rn.round(u-.5),R&&(d=rn.max(a,d),y=rn.min(s,y));d<=y;++d)if(m=d<p?k?(h=t,r):(h=x*(d-e)/w+t,v*(d-e)/C+t):I?(h=r,l):(h=x*(d-e)/w+t,b*(d-i)/T+r),rn.abs(m-h)<1)(!R||o<=h&&h<=f)&&n(rn.round(h),d,1);else for(m<h&&(g=h,h=m,m=g),h=rn.round(h+.5),m=rn.round(m-.5),R&&(h=rn.max(o,h),m=rn.min(f,m));h<=m;++h)n(h,d,c)}}function F(n,t,e,r,i,l,u,o,a,f,s,c,h){var m,g,d,p,y,x,v,b,w,C,T,E,G,k,I,R,P,S,q,z,A,D,J,L,O,M=null!=a;for(i<e&&(S=e,e=i,i=S,S=t,t=r,r=S),S=l,q=u,D=r,J=i,L=(D-=z=t)*(S-=z)+(J-=A=e)*(q-=A),O=an(D,J),an(S,q),z=l+o/(q=an(l-(C=[z+(S=L/O)*D/O,A+S*J/O])[0],u-C[1]))*(C[0]-l),L=u+o/q*(C[1]-u),D=rn.atan2(u-L,l-z),A=rn.atan2(e-L,t-z),J=rn.atan2(i-L,r-z),D=Q(D),O=Q(A),q=Q(J),R=(C=_(z,L,o,o,0,A,J,!(D<O&&D<q||O<D&&q<D||O<D&&D<q))).length-2,null==h&&(h=1),k=0;k<R;k+=2)N(n,C[k],C[k+1],C[k+2],C[k+3],null,null,h,a,f,s,c);for(C=X([C]),m=rn.round(rn.min(e,i,u,C.ymin)),g=rn.round(rn.max(e,i,u,C.ymax)),M&&(m=rn.max(m,f),g=rn.min(g,c)),T=r-t,G=Y(E=i-e,0),k=0,R=C.length;m<=g;++m){for(;k<R&&C[k][3]<m;)++k;if(R<=k)break;if((P=C[k])[1]>m)m=rn.floor(P[1]);else{for(p=-(d=ln),e<=m&&m<=i&&(p=G?(d=rn.min(d,t,r),rn.max(p,t,r)):(d=rn.min(d,y=T*(m-e)/E+t),rn.max(p,y))),I=k;I<R&&C[I][1]<=m;++I)(P=C[I])[3]>=m&&(x=P[0],v=P[2],p=Y(b=P[1],w=P[3])?(d=rn.min(d,x,v),rn.max(p,x,v)):(d=rn.min(d,y=(v-x)*(m-b)/(w-b)+x),rn.max(p,y)));for(d=rn.round(d+.5),p=rn.round(p-.5),M&&(d=rn.max(d,a),p=rn.min(p,s));d<=p;++d)n(d,m,h)}}}function N(n,t,e,r,i,l,u,o,a,f,s,c,h,m,g){var d=rn.min(t,r),p=rn.max(t,r),y=rn.min(e,i),x=rn.max(e,i),v=o<1?o:1,o=null!=a;if((v=null!=g&&g<v?g:v)&&(!o||!(p<a||s<d||x<f||c<y))){if(null==l&&(l=rn.abs(r-t),u=rn.abs(i-e)),o&&(d<a||s<p||y<f||c<x)){g=function(n,t,e,r,i,l,u,o){if(null!=i){var e=-(e-n),a=-e,r=-(r-t),f=-r,i=n-i,u=u-n,l=t-l,o=o-t,s=1,c=0;if(!(0==e&&i<0||0==a&&u<0||0==r&&l<0||0==f&&o<0||(0!=e&&(i=i/e,u=u/a,e<0?(c<i&&(c=i),u<s&&(s=u)):(c<u&&(c=u),i<s&&(s=i))),0!=r&&(e=l/r,u=o/f,r<0?(c<e&&(c=e),u<s&&(s=u)):(c<u&&(c=u),e<s&&(s=e))),s<c)))return[n+a*c,t+f*c,n+a*s,t+f*s]}}(t,e,r,i,a,f,s,c);if(!g)return v;t=g[0],e=g[1],r=g[2],i=g[3]}if(Y(l,0)||Y(u,0))q(n,rn.round(t),rn.round(e),rn.round(r),rn.round(i),null,null,null,null,v);else{var b,w,C,T,k=0,I=0,R=0,o=l<u;if(o&&(b=t,t=e,e=b,b=r,r=i,i=b,b=l,l=u,u=b),r<t&&(b=t,t=r,r=b,w=e,e=i,i=w),p=e+(T=(i<e?-1:1)*u/l)*((d=rn.round(t))-t),y=h?1:1-(t+.5-rn.floor(t+.5)),x=d,R=1-(I=p-(a=rn.floor(p))),o?(n(a,x,v*R*y),n(a+1,x,v*I*y)):(n(x,a,v*R*y),n(x,a+1,v*I*y)),k=p+T,p=i+T*((d=rn.round(r))-r),y=m?1:r+.5-rn.floor(r+.5),C=d,R=1-(I=p-(f=rn.floor(p))),o?(n(f,C,v*R*y),n(f+1,C,v*I*y)):(n(C,f,v*R*y),n(C,f+1,v*I*y)),o)for(b=x+1;b<C;++b)0<(R=1-(I=k-(w=rn.floor(k))))&&n(w,b,v*R),0<I&&n(w+1,b,v*I),k+=T;else for(b=x+1;b<C;++b)0<(R=1-(I=k-(w=rn.floor(k))))&&n(b,w,v*R),0<I&&n(b,w+1,v*I),k+=T}}return v}function cn(n,t,e,r,i,l,u,o,a,f,s,c,h,m,g,d,p,y,x,v,b,w){var C,T,k,I,R,P,S,q,z=r<t||t===r&&o<0?-1:1,A=i<e||e===i&&a<0?-1:1,D=l<r||r===l&&c<0?-1:1,J=u<i||i===u&&h<0?-1:1;o=rn.abs(o),B(A*(a=rn.abs(a))*D*(c=rn.abs(c)),J*(h=rn.abs(h))*z*o,1e-6)||(null==w&&(w=1),C={x:t-(q=z*f),y:e+(S=A*s)},t={x:t+q,y:e-S},e={x:r-q,y:i+S},q={x:r+q,y:i-S},P={x:r-(S=D*m),y:i+(R=J*g)},T={x:r+S,y:i-R},k={x:l-S,y:u+R},l={x:l+S,y:u-R},S={x:r,y:i},u=J*h*z*o<A*a*D*c?(I=e,P):(I=q,T),D*A*z*J<0&&(I=q===I?e:q,u=T===u?P:T),z*J<0&&(I=q===I?e:q),D*A<0&&(u=T===u?P:T),z*D<0&&(I=q===I?e:q,u=T===u?P:T),"bevel"===d?(N(n,I.x,I.y,u.x,u.y,null,null,w,y,x,v,b),M(n,S.x,S.y,I.x,I.y,u.x,u.y,y,x,v,b,w)):(r=(R=I===q?t:C).x,i=R.y,h=I.x,o=I.y,a=u.x,c=u.y,J=o-i,A=r-h,h=h*i-r*o,o=(D=(z=u===T?l:k).x)*c-a*(e=z.y),q=an((P=!Y(D=J*(r=a-D)-A*(i=e-c),0)&&{x:(A*o-h*r)/D,y:(h*i-J*o)/D}).x-S.x,P.y-S.y),t=rn.min(an(f,s),an(m,g)),"round"===d?(P={x:S.x+t*(P.x-S.x)/q,y:S.y+t*(P.y-S.y)/q},M(n,S.x,S.y,I.x,I.y,u.x,u.y,y,x,v,b,w),F(n,I.x,I.y,u.x,u.y,P.x,P.y,t,y,x,v,b,w)):p*t<q?(N(n,I.x,I.y,u.x,u.y,null,null,w,y,x,v,b),M(n,S.x,S.y,I.x,I.y,u.x,u.y,y,x,v,b,w)):(N(n,I.x,I.y,P.x,P.y,null,null,w,y,x,v,b),N(n,u.x,u.y,P.x,P.y,null,null,w,y,x,v,b),M(n,S.x,S.y,I.x,I.y,u.x,u.y,y,x,v,b,w),M(n,P.x,P.y,I.x,I.y,u.x,u.y,y,x,v,b,w))))}function _(r,i,l,u,n,o,t,e,a){f=t,e=e,s=Q(c=o),f+=s-c,!e&&w<=f-s?f=s+w:e&&w<=s-f?f=s-w:!e&&f<s?f=s+(w-Q(s-f)):e&&s<f&&(f=s-(w-Q(f-s)));var f,s,c=[s,f],h=(o=c[0],t=c[1],n?rn.cos(n):1),m=n?rn.sin(n):0,g=t-o,d=a&&!a.isIdentity;return p(function(n){var n=o+n*g,t=l*rn.cos(n),n=u*rn.sin(n),e=r+h*t-m*n,t=i+m*t+h*n;return d?a.transform(e,t):[e,t]},d?a.sx:1,d?a.sy:1)}function A(n,t,e,r,i,l,u,o){var a=[],n=function(n,t,e,r,i,l,u){if(B(e,n)&&B(r,t)||B(e,i)&&B(r,l)||B(u,0))return[e,r];var o,a,f,s=!1;if(i={x:i-e,y:l-r},a=an((l={x:n-e,y:t-r}).x,l.y),f=an(i.x,i.y),Y(o=(l.x*i.x+l.y*i.y)/(a*f),-1))return[e,r];if(Y(o,1))return[n+(n=65535/a)*l.x,t+n*l.y];t=u/rn.tan(rn.acos(o)/2),o={x:e+(n=t/a)*l.x,y:r+n*l.y},n=an((a={x:l.y,y:-l.x}).x,a.y),l=u/n,(a.x*i.x+a.y*i.y)/(n*f)<0&&(a={x:-a.x,y:-a.y});l={x:o.x+l*a.x,y:o.y+l*a.y},a={x:-a.x,y:-a.y},n=rn.acos(a.x/n),a.y<0&&(n=w-n);f=an((t={x:(e={x:e+(a=t/f)*i.x,y:r+a*i.y}).x-l.x,y:e.y-l.y}).x,t.y),r=rn.acos(t.x/f),t.y<0&&(r=w-r);r<n&&n-r<c&&(s=!0);n<r&&c<r-n&&(s=!0);return[o.x,o.y,l.x,l.y,n,r,!(!s||B(w,u))]}(n,t,e,r,i,l,u);return n&&2<=n.length&&(t=o?o.transform(n[0],n[1]):[n[0],n[1]],a.push(t[0],t[1]),2<n.length)&&a.push.apply(a,_(n[2],n[3],u,u,0,n[4],n[5],n[6],o)),a}function u(u,n){var t=n&&!n.isIdentity;return p(6<u.length?function(n){var t=1-n,e=n*n,r=t*t,i=r*t,l=e*n,r=3*r*n,n=3*e*t;return[i*u[0]+r*u[2]+n*u[4]+l*u[6],i*u[1]+r*u[3]+n*u[5]+l*u[7]]}:function(n){var t=1-n,e=t*t,t=2*t*n,n=n*n;return[e*u[0]+t*u[2]+n*u[4],e*u[1]+t*u[3]+n*u[5]]},t?n.sx:1,t?n.sy:1)}function j(E,G,M,n,F,N,_,j,B,Y,U,Q,V,X){var t={length:0,min:ln,offset:F};n.forEach(function(n){t.length+=n,t.min=rn.min(t.min,n)}),1<=t.min&&(t.min=1),t.length<=t.offset&&(t.offset-=rn.floor(t.offset/t.length)*t.length),t.offset<0&&(t.offset+=rn.ceil(-t.offset/t.length)*t.length),t.offset/=t.min;for(var e,r=0,$=G._d,H=$.length;r<H;++r)if((e=$[r])&&2<e.length)for(var W=n.length?function(n,t,e,r,i,l){for(var u,o,a,f,s,c,h,m,g,d,p,y,x=n.length,v=(x>>>1)-1,b=new Array(v),w=t.length,C=0,T=[],k=0,I=0;k<v;++k,I+=2)u=an((+n[I+2]-n[I])/i,(+n[I+3]-n[I+1])/l),C+=b[k]=u;for(h={x:n[0],y:n[1],i:0,l:0},m={x:n[x-2],y:n[x-1],i:0,l:0},o=0,p=-e;p<C;)a=t[o]/r,f=t[o+1]/r,0<a&&0<p+a&&(fn(n,b,p,h,m,C),fn(n,b,p+a-1,m,h,C),y=null,h.i+1<m.i?((y=[]).push(h.x),y.push(h.y),y.push.apply(y,n.slice(h.i+1<<1,m.i<<1)),y.push(m.x),y.push(m.y)):h.i<m.i?y=[h.x,h.y,n[m.i<<1],n[1+(m.i<<1)],m.x,m.y]:h.i===m.i&&(y=[h.x,h.y,m.x,m.y]),y)&&y.length&&((R=(d=T.length?T[T.length-1]:null)?{x:d[d.length-2],y:d[d.length-1],i:d.i}:null)&&h.i-1===R.i&&(g={x:n[h.i<<1],y:n[1+(h.i<<1)],i:h.i},s+c<an((+R.x-g.x)/i,(+R.y-g.y)/l)+an((+g.x-h.x)/i,(+g.y-h.y)/l)+e)&&(S=n[R.i<<1],q=n[1+(R.i<<1)],R.i,R=n[2+(h.i<<1)],P=n[3+(h.i<<1)],h.i,T.push([g.x,{dx:+g.x-S,dy:+g.y-q,v:g.y,valueOf:un},g.x,g.y,g.x,{dx:+R-g.x,dy:+P-g.y,v:g.y,valueOf:un}]),T[T.length-1].i=h.i,T[T.length-1].alpha=d.alpha),y.i=m.i,y.alpha=rn.max(.7,t[o]<1?t[o]:1),T.push(y)),0<a&&(p+=a),0<f&&(p+=f),s=a,c=f,w<=(o+=2)&&(o=0);var R,P;var S,q;return T}(e,n,t.offset,t.min,B,Y):[e],i=0,Z=W.length;i<Z;++i)if(0<W[i].length){en=tn=O=L=w=b=v=x=y=p=d=g=m=h=c=s=f=a=o=u=l=J=D=A=z=q=S=P=nn=K=R=I=k=T=C=void 0;var l,u,o,a,f,s,c,h,m,g,d,p,y,x,v,b,w,C=E,T=W[i],k=M,I=0===i?N:"butt",R=Z===1+i?N:"butt",K=_,nn=j,P=B,S=Y,q=U,z=Q,A=V,D=X,J=T.length,L=K,O=0,tn=I,en=R;if(J<6)O=sn(C,+(u=T[0]),+(o=T[1]),+(a=T[2]),+(f=T[3]),g=rn.abs(+a-u),d=rn.abs(+f-o),(w=on(k,g,d,P,S,p=(null==o.dx?f:o).dx,y=(null==o.dy?f:o).dy))[0],w[1],I,R,k,q,z,A,D,p,y,T.alpha);else for(J-=2,l=0;l<J;l+=2)u=T[l],o=T[l+1],a=T[l+2],f=T[l+3],w=on(k,g=rn.abs(a-u),d=rn.abs(f-o),P,S,p=(null==o.dx?f:o).dx,y=(null==o.dy?f:o).dy),u.params&&u.params.lineCap&&(tn=!0===u.params.lineCap?I:u.params.lineCap),a.params&&a.params.lineCap&&(en=!0===a.params.lineCap?R:a.params.lineCap),O=rn.max(O,sn(C,+u,+o,+a,+f,g,d,w[0],w[1],0===l?tn:null,J===l+2?en:null,k,q,z,A,D,p,y,T.alpha)),0<l&&(0<b[0]||0<b[1]||0<w[0]||0<w[1])&&(u.params&&u.params.lineJoin&&(L=!0===u.params.lineJoin?K:u.params.lineJoin),cn(C,+s,+c,+u,+o,+a,+f,x||h,v||m,b[0],b[1],p||g,y||d,w[0],w[1],L,nn,q,z,A,D,O)),s=u,c=o,h=g,m=d,x=p,v=y,b=w;a.params&&a.params.join&&(s=a.params.join[0],c=a.params.join[1],0<(b=on(k,h=rn.abs(s-a),m=rn.abs(c-f),P,S,x=null,v=null))[0]||0<b[1]||0<w[0]||0<w[1])&&cn(C,+u,+o,+a,+f,+s,+c,p||g,y||d,w[0],w[1],x||h,v||m,b[0],b[1],L,nn,q,z,A,D,O)}}function X(n){if(!n)return[];for(var t,e,r,i,l=[],u=n.length,o=ln,a=-ln,f=0,s=0,c=0;c<u;++c)if((i=n[c])&&!((t=i.length-2)<=0)){for(++f,r=-(s=1),e=0;e<t;e+=2)i[e].params&&i[e].params.type&&(0<=r&&r<l.length&&(l[r][7]=l[r+s-2][6]+1,l[r+s-2][7]=l[r][6]+1),++f,s=1,r=l.length),o=rn.min(o,i[e+1]),a=rn.max(a,i[e+1]),i[e+1]>i[e+3]?l.push([+i[e+2],i[e+3],+i[e],i[e+1],-1,f,s,s,0,0]):l.push([+i[e],i[e+1],+i[e+2],i[e+3],1,f,s,s,0,0]),++s;o=rn.min(o,i[1+t]),a=rn.max(a,i[1+t])}return(l=l.sort(d)).ymin=o,l.ymax=a,l}function $(n,t){for(var e,r,i,l=0,u=0;u<t;++u)if(!(r=n[u])[9])for(e=u+1;e<t;++e)(i=n[e])[9]||r[4]!==i[4]||r[5]!==i[5]||1<rn.abs(r[6]-i[6])&&1<rn.abs(r[7]-i[7])||(B(r[0],i[0],1e-6)&&B(r[1],i[1],1e-6)&&B(r[2],i[2],1e-6)&&B(r[3],i[3],1e-6)||B(r[3],i[1],1e-6)||B(r[1],i[3],1e-6))&&(i[9]=1,++l);return l}function p(n,t,e){var r,i=[],l=o,u=n(0);for(i.push(u[0],u[1]),r=0;r<l;++r)u=function n(t,e,r,i,l,u,o,a){if(u<=l||B(l,u,1e-6))return o;o=o||e(l);a=a||e(u);var f,s=rn.max(r,i),c=an(a[0]-o[0],a[1]-o[1])*s;if(c<=h){if(c<1)return o;t.push(a[0],a[1])}else g((f=e(c=(l+u)/2))[0],f[1],o[0],o[1],a[0],a[1])*s<m?t.push(a[0],a[1]):(n(t,e,r,i,l,c,o,f),n(t,e,r,i,c,u,f,a));return a}(i,n,t,e,0===r?0:r/l,l===r+1?1:(r+1)/l,u,null);return i}function H(n,t,e,r,i,l){return(n-e)*(l-r)-(i-e)*(t-r)<0?-1:1}function an(n,t){n=rn.abs(n),t=rn.abs(t);var e=0;return Y(n,0)?t:Y(t,0)?n:t<n?n*rn.sqrt(1+(e=t/n)*e):n<t?t*rn.sqrt(1+(e=n/t)*e):n*r}function g(n,t,e,r,i,l){var i=i-e,l=l-r,u=an(i,l);return Y(u,0)?an(n-e,t-r):rn.abs(i*(r-t)-l*(e-n))/u}function W(n,t,e,r){var i,l,u=n*r-t*e;return e=e,r=r,i=an(n=n,t=t),l=an(e,r),(u<0?-1:1)*(Y(i,0)||Y(l,0)?0:rn.acos(U(n/i*(e/l)+t/i*(r/l),-1,1)))}function B(n,t,e){return rn.abs(+n-t)<(e||1e-6)}function Y(n,t){return rn.abs(+n-t)<l}function U(n,t,e){return rn.min(rn.max(n,t),e)}function Q(n){return n=n,e=0,r=t=w,(n-=t*rn.floor(n/t))<e&&(n+=t),r<n&&(n-=t),n;var t,e,r}function d(n,t){var e=n[1]-t[1];return B(e,0)?n[3]-t[3]:e}function Z(n){return parseFloat(n||"")||0}function K(n){return n.trim()}function V(n){throw new Error(n)}function t(){}return O.VERSION="1.0.0",O[n]={constructor:O,width:null,height:null,getContext:null},O.getRGBAFrom=function(l){var e;return"function"==typeof l?function(n,t){n=l(n,t);return[n[0],n[1],n[2],3<n.length?n[3]/255:1]}:l.data&&null!=l.width&&null!=l.height?function(n,t){var e=l.width,r=l.height,i=l.data;return 0<=n&&n<e&&0<=t&&t<r?[i[r=n+e*t<<2],i[1+r],i[2+r],i[3+r]/255]:L}:(e=[l[0]||0,l[1]||0,l[2]||0,3<l.length?l[3]||0:1],function(n,t){return e})},O.setRGBATo=function(y){var n;return"function"==typeof y?y:((n=function(n,t,e,r,i,l,u){var o=y.width,a=y.height,f=y.data;if(0<=n&&n<o&&0<=t&&t<a){var a=n+o*t<<2,n=f[a]||0,o=f[1+a]||0,t=f[2+a]||0,s=(f[3+a]||0)/255,c=l,h=null,m=0,g=0,d=0,p=0;switch("clear"!==(u=u||"source-over")&&"copy"!==u&&(h=(h=x.CompositionMode[u])||x.CompositionMode[u="source-over"]),u){case"clear":h=null;break;case"copy":m=e,g=r,d=i,p=U(rn.round(255*c),0,255),h=null;break;case"xor":case"destination-out":case"destination-in":case"destination-atop":case"destination-over":case"source-out":case"source-in":case"source-atop":case"source-over":p=h(s,s,c,c);break;default:p=c+s-c*s}h&&(p=0<p?(m=U(rn.round(255*h(s*n/255,s,c*e/255,c)/p),0,255),g=U(rn.round(255*h(s*o/255,s,c*r/255,c)/p),0,255),d=U(rn.round(255*h(s*t/255,s,c*i/255,c)/p),0,255),U(rn.round(255*p),0,255)):d=g=m=0),f[a]=m,f[1+a]=g,f[2+a]=d,f[3+a]=p}}).$target=y,n)},x[n]={constructor:x,strokeStyle:null,fillStyle:null,lineWidth:null,lineCap:null,lineJoin:null,miterLimit:null,lineDash:null,lineDashOffset:null,getLineDash:null,setLineDash:null,globalAlpha:null,globalCompositeOperation:null,save:null,restore:null,reset:null,scale:null,rotate:null,translate:null,transform:null,getTransform:null,setTransform:null,resetTransform:null,beginPath:null,closePath:null,moveTo:null,lineTo:null,rect:null,arc:null,ellipse:null,arcTo:null,quadraticCurveTo:null,bezierCurveTo:null,clearRect:null,strokeRect:null,fillRect:null,stroke:null,fill:null,clip:null,isPointInStroke:null,isPointInPath:null,createImageData:function(n,t){return null==t&&null!=n.width&&null!=n.height&&(t=n.height,n=n.width),{data:new J(n*t<<2),width:n,height:t}},getImageData:null,putImageData:null,drawImage:null,createLinearGradient:t,createRadialGradient:t,createConicGradient:t,createPattern:t,strokeText:t,fillText:t,measureText:t},((O.RenderingContext2D=x).CompositionMode={xor:function(n,t,e,r){return e*(1-t)+n*(1-r)},"destination-out":function(n,t,e,r){return n*(1-r)},"destination-in":function(n,t,e,r){return n*r},"destination-atop":function(n,t,e,r){return e*(1-t)+n*r},"destination-over":function(n,t,e,r){return e*(1-t)+n},"source-out":function(n,t,e,r){return e*(1-t)},"source-in":function(n,t,e,r){return e*t},"source-atop":function(n,t,e,r){return e*t+n*(1-r)},"source-over":function(n,t,e,r){return e+n*(1-r)},multiply:function(n,t,e,r){return e*n+e*(1-t)+n*(1-r)},screen:function(n,t,e,r){return e+n-e*n},overlay:function(n,t,e,r){return 2*n<=t?2*e*n+e*(1-t)+n*(1-r):e*(1+t)+n*(1+r)-2*n*e-t*r},darken:function(n,t,e,r){return rn.min(e*t,n*r)+e*(1-t)+n*(1-r)},lighten:function(n,t,e,r){return rn.max(e*t,n*r)+e*(1-t)+n*(1-r)},"color-dodge":function(n,t,e,r){return e===r&&0===n?e*(1-t):e===r?r*t+e*(1-t)+n*(1-r):r*t*rn.min(1,n/t*r/(r-e))+e*(1-t)+n*(1-r)},"color-burn":function(n,t,e,r){return 0===e&&n===t?r*t+n*(1-r):0===e?n*(1-r):r*t*(1-rn.min(1,(1-(t?n/t:0))*r/e))+e*(1-t)+n*(1-r)},"hard-light":function(n,t,e,r){return 2*e<=r?2*e*n+e*(1-t)+n*(1-r):e*(1+t)+n*(1+r)-r*t-2*e*n},"soft-light":function(n,t,e,r){var i=t?n/t:0;return 2*e<=r?n*(r+(2*e-r)*(1-i))+e*(1-t)+n*(1-r):r<2*e&&4*n<=t?t*(2*e-r)*(16*rn.pow(i,3)-12*rn.pow(i,2)-3*i)+e-e*t+n:t*(2*e-r)*(rn.pow(i,.5)-i)+e-e*t+n},difference:function(n,t,e,r){return e+n-2*rn.min(e*t,n*r)},exclusion:function(n,t,e,r){return e*t+n*r-2*e*n+e*(1-t)+n*(1-r)}}).hardlight=x.CompositionMode["hard-light"],x.CompositionMode.softlight=x.CompositionMode["soft-light"],x.Interpolation={},E[n]={constructor:E,_d:null,_sd:null,transform:null,dispose:null,addPath:null,moveTo:null,lineTo:null,rect:null,roundRect:null,arc:null,ellipse:null,arcTo:null,quadraticCurveTo:null,bezierCurveTo:null,closePath:null},x.Path2D=E,G[n]={constructor:G,is2D:!0,isIdentity:!0,m11:1,m12:0,m13:0,m21:0,m22:1,m23:0,m31:0,m32:0,m33:1,a:null,b:null,c:null,d:null,e:null,f:null,clone:function(){var n=this,t=new G(n.m11,n.m12,n.m13,n.m21,n.m22,n.m23);return t.sx=n.sx,t.sy=n.sy,t},mul:function(n){var t,e=this;if(n instanceof G)return(t=new G(e.m11*n.m11+e.m12*n.m21,e.m11*n.m12+e.m12*n.m22,e.m11*n.m13+e.m12*n.m23+e.m13,e.m21*n.m11+e.m22*n.m21,e.m21*n.m12+e.m22*n.m22,e.m21*n.m13+e.m22*n.m23+e.m23)).sx=e.sx*n.sx,t.sy=e.sy*n.sy,t},inv:function(){var n=this,t=n.m11,e=n.m12,r=n.m13,i=n.m21,l=n.m22,u=n.m23,o=t*l-e*i;return Y(o,0)?null:((i=new G(l=l/o,e=-e/o,-l*r-e*u,l=-i/o,e=t/o,-l*r-e*u)).sx=1/n.sx,i.sy=1/n.sy,i)},transform:function(n,t,e){2===arguments.length&&t&&t.length?(e=t,t=n[1],n=n[0]):1===arguments.length&&(t=n[1],n=n[0]);var r=this,i=r.m11*n+r.m12*t+r.m13,n=r.m21*n+r.m22*t+r.m23;return e&&e.length?(e[0]=i,e[1]=n):e=[i,n],e}},G.translate=function(n,t){return new G(1,0,n||0,0,1,t||0)},G.scale=function(n,t,e,r){e=new G(n,0,-n*(e=e||0)+e,0,t,-t*(r=r||0)+r);return e.sx=n,e.sy=t,e},G.rotate=function(n,t,e){t=t||0,e=e||0;var r=rn.cos(n||0),n=rn.sin(n||0);return new G(r,-n,t-r*t+n*e,n,r,e-r*e-n*t)},G.skewX=function(n){return new G(1,n||0,0,0,1,0)},G.skewY=function(n){return new G(1,0,0,n||0,1,0)},G.EYE=function(){return new G(1,0,0,0,1,0)},x.Matrix2D=G,C[n]={constructor:C,value:0,params:null,valueOf:function(){return this.value},toString:function(){return String(this.value)}},O});