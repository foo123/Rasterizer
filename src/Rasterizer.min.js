/**
*   Rasterizer
*   rasterize, draw and fill lines, rectangles and curves
*
*   @version 0.9.6
*   https://github.com/foo123/Rasterizer
*
**/
!function(e,n,t){"use strict";"object"==typeof module&&module.exports?module.exports=t.call(e):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return t.call(e)}):n in e||(e[n]=t.call(e)||1)&&"function"==typeof define&&define.amd&&define(function(){return e[n]})}("undefined"!=typeof self?self:this,"Rasterizer",function(e){"use strict";var g=Object.defineProperty,n="prototype",tn=Math,r=tn.sqrt(2),x=tn.PI,d=2*x,v=x/2,l=6,f=r,s=.5,t="undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:"undefined"!=typeof Uint8Array?Uint8Array:Array;function b(e,t,n){if(!(this instanceof b))return new b(e,t,n);var r=new u(e,t,n);g(this,"width",{get:function(){return e},set:function(n){e=+n}}),g(this,"height",{get:function(){return t},set:function(n){t=+n}}),this.getContext=function(n){if("2d"===n)return r;R('Unsupported context "'+n+'"')}}function u(D,_,l){var r,u=this,i=b.getRGBAFrom([0,0,0,1]),o=b.getRGBAFrom([0,0,0,1]),A=1,t="butt",a="miter",f=10,s=1,e=[],c=0,h=w.EYE(),m=1,p="source-over",S=new N(h),I=function(){r={}},k=function(n){for(var e in r){var t=r[e],e=e.split(",");n(+e[0],+e[1],t)}},E=function(n,e,t){0<=n&&n<D&&0<=e&&e<_&&0<t&&0<m&&(t*=A*m,n=String(n)+","+String(e),(r[n]||0)<t)&&(r[n]=t)},y=function(n,e,t){var r=i(n,e),u=3<r.length?r[3]:1;0<u&&l(n,e,r[0],r[1],r[2],u*t,p)},L=function(n,e,t){var r=o(n,e),u=3<r.length?r[3]:1;0<u&&l(n,e,r[0],r[1],r[2],u*t,p)};g(u,"strokeStyle",{get:function(){return""},set:function(n){i=b.getRGBAFrom(n)}}),g(u,"fillStyle",{get:function(){return""},set:function(n){o=b.getRGBAFrom(n)}}),g(u,"lineWidth",{get:function(){return s},set:function(n){0<=(n=+n)&&isFinite(n)&&(s=n)}}),g(u,"lineCap",{get:function(){return t},set:function(n){n=String(n).toLowerCase(),-1!==["butt","square"].indexOf(n)?t=n:R('"'+n+'" lineCap is not supported!')}}),g(u,"lineJoin",{get:function(){return a},set:function(n){n=String(n).toLowerCase(),-1!==["miter","bevel"].indexOf(n)?a=n:R('"'+n+'" lineJoin is not supported!')}}),g(u,"miterLimit",{get:function(){return f},set:function(n){0<=(n=+n)&&isFinite(n)&&(f=n)}}),g(u,"lineDashOffset",{get:function(){return c},set:function(n){0<=(n=+n)&&isFinite(n)&&(c=n)}}),g(u,"lineDash",{get:function(){return e.slice()},set:function(n){1&(n=[].concat(n)).length&&(n=n.concat(n)),e=n}}),u.getLineDash=function(){return u.lineDash},u.setLineDash=function(n){u.lineDash=n},g(u,"globalAlpha",{get:function(){return m},set:function(n){0<=(n=+n)&&n<=1&&(m=n)}}),g(u,"globalCompositeOperation",{get:function(){return p},set:function(n){p=String(n)}}),u.scale=function(n,e){S._t=h=w.scale(n,e).mul(h)},u.rotate=function(n){S._t=h=w.rotate(n||0).mul(h)},u.translate=function(n,e){S._t=h=w.translate(n||0,e||0).mul(h)},u.transform=function(n,e,t,r,u,l){S._t=h=new w(n,t,u,e,r,l).mul(h)},u.getTransform=function(){return h.clone()},u.setTransform=function(n,e,t,r,u,l){1<arguments.length?h=new w(n,t,u,e,r,l):null!=n.m00&&n.clone&&(h=n.clone()),S._t=h},u.resetTransform=function(){S._t=h=w.EYE()},u.beginPath=function(){S=new N(h)},u.closePath=function(){S.closePath()},u.moveTo=function(n,e){S.moveTo(n,e)},u.lineTo=function(n,e){S.lineTo(n,e)},u.rect=function(n,e,t,r){S.rect(n,e,t,r)},u.roundRect=function(n,e,t,r){S.roundRect.apply(S,arguments)},u.arc=function(n,e,t,r,u,l){S.arc(n,e,t,r,u,l)},u.ellipse=function(n,e,t,r,u,l,i,o){S.ellipse(n,e,t,r,u,l,i,o)},u.arcTo=function(n,e,t,r,u){S.arcTo(n,e,t,r,u)},u.quadraticCurveTo=function(n,e,t,r){S.quadraticCurveTo(n,e,t,r)},u.bezierCurveTo=function(n,e,t,r,u,l){S.bezierCurveTo(n,e,t,r,u,l)},u.strokeRect=function(n,e,t,r){0<s&&u.stroke(new N(h).rect(n,e,t,r))},u.fillRect=function(n,e,t,r){u.fill(new N(h).rect(n,e,t,r),"evenodd")},u.stroke=function(n){var e;0<s&&(e=A,s<1&&(A=s),I(),O(E,n||S,s,0,0,t,a,f,0,0,D-1,_-1),k(y),A=e)},u.fill=function(n,e){!arguments.length||null==n&&null==e?(n=S,e="nonzero"):1!==arguments.length&&null!=e||(n instanceof N?e="nonzero":(e=n,n=S)),"evenodd"!==(e=String(e||"nonzero").toLowerCase())&&(e="nonzero");var t=A,r=D-1,u=_-1,l=(I(),O(E,n=n||S,A=.65,0,0,"butt","bevel",0,0,0,r,u),A=t,E),t=n,n=e,i=0,e=0,o=r,r=u,a=t._sd;if(a.length){var f,s,c,h,m,p,y,g,x,d,v,b,w,C,T=a.length,P=new Array(T),q=a.ymin,J=a.ymax,R=0,z="evenodd"===n;for(q=tn.max(e,tn.round(q)),J=tn.min(r,tn.round(J));q<=J;++q){for(;R<T&&a[R][3]<q;)++R;if(T<=R)break;if((c=a[R])[1]>q)q=tn.floor(c[1]);else{for(d=c[0],v=c[2],m=c[1],p=c[3],x=cn(m,p)?(b=!1,g=tn.min(d,v),tn.max(d,v)):g=b=(v-d)*(q-m)/(p-m)+d,c[7]=b,c[8]=0,P[0]=c,f=R+(s=1);f<T&&a[f][1]<=q;++f)(c=a[f])[3]>=q&&(d=c[0],v=c[2],m=c[1],p=c[3],x=cn(m,p)?(b=!1,g=tn.min(g,d,v),tn.max(x,d,v)):(b=(v-d)*(q-m)/(p-m)+d,g=tn.min(g,b),tn.max(x,b)),c[7]=b,c[8]=0,P[s++]=c);if(h=B(P,s),!(s<h+2||(g=tn.max(i,tn.round(g+.5)),(x=tn.min(o,tn.round(x-.5)))<g)))if(z)for(y=g;y<=x;++y){for(C=w=!1,f=0;f<s;++f)(c=P[f])[8]||!1!==(b=c[7])&&(b<y&&(w=!w),y<b)&&(C=!C);w&&C&&l(y,q,1)}else for(y=g;y<=x;++y){for(f=C=w=0;f<s;++f)(c=P[f])[8]||!1!==(b=c[7])&&(b<y||y<b)&&(h=F(y,q,c[c[4]<0?2:0],c[c[4]<0?3:1],c[c[4]<0?0:2],c[c[4]<0?1:3]),b<y&&(w+=h),y<b)&&(C+=h);w&&C&&l(y,q,1)}}}}k(L)},u.isPointInStroke=function(n,e,t){arguments.length<3&&(t=e,e=n,n=S);var r,u,l,i,o,a,f,s=e||0,c=t||0,e=n||S,h=e._d,m=h.length;for(r=0;r<m;++r)if(l=h[r],0<(i=l.length-2))for(u=0;u<i;u+=2)if(o=+l[u],a=l[u+1],f=+l[u+2],sn((l[u+3]-a)*(s-o),(c-a)*(f-o),1e-4))return!0;return!1},u.isPointInPath=function(n,e,t,r){n instanceof N||(t=e,e=n,n=S),"evenodd"!==(r=String(r||"nonzero").toLowerCase())&&(r="nonzero");var u=e||0,l=t||0,e=r,i=(t=n||S)._sd;if(!(!i.length||l<i.ymin||l>i.ymax)){for(var o,a,f,s,c,h,m,p,y,g,x,d,v,b=i.length,w=new Array(b),C=0,t="evenodd"===e;C<b&&i[C][3]<l;)++C;if(!(b<=C||(f=i[C])[1]>l)){for(y=f[0],g=f[2],c=f[1],h=f[3],p=cn(c,h)?(x=!1,m=tn.min(y,g),tn.max(y,g)):m=x=(g-y)*(l-c)/(h-c)+y,f[7]=x,f[8]=0,w[0]=f,o=C+(a=1);o<b&&i[o][1]<=l;++o)(f=i[o])[3]>=l&&(y=f[0],g=f[2],c=f[1],h=f[3],p=cn(c,h)?(x=!1,m=tn.min(m,y,g),tn.max(p,y,g)):(x=(g-y)*(l-c)/(h-c)+y,m=tn.min(m,x),tn.max(p,x)),f[7]=x,f[8]=0,w[a++]=f);if(s=B(w,a),a<s+2)return!1!==w[0][7]&&sn(u,w[0][7]);if(!(p<m||u<m||p<u)){if(t)for(v=d=!1,o=0;o<a;++o)(f=w[o])[8]||!1!==(x=f[7])&&(x<=u&&(d=!d),u<=x)&&(v=!v);else for(o=v=d=0;o<a;++o)(f=w[o])[8]||!1!==(x=f[7])&&(x<u||u<x)&&(s=F(u,l,f[f[4]<0?2:0],f[f[4]<0?3:1],f[f[4]<0?0:2],f[f[4]<0?1:3]),x<=u&&(d+=s),u<=x)&&(v+=s);if(d&&v)return!0}}}return!1}}function N(i){i=i||w.EYE();var h=this,m=!0,p=[],y=null;g(h,"_t",{get:function(){return i.clone()},set:function(n){i=n}}),g(h,"_d",{get:function(){return p},set:function(n){}}),g(h,"_sd",{get:function(){return y=y||function(n){if(!n)return[];var e,t,r,u,l,i,o=[],a=n.length,f=1/0,s=-1/0;for(r=l=u=0;r<a;++r)if((i=n[r])&&!((e=i.length-2)<=0)){for(t=0;t<e;t+=2)i[t].params&&i[t].params.type&&(++u,l=0),f=tn.min(f,i[t+1]),s=tn.max(s,i[t+1]),i[t+1]>i[t+3]?o.push([+i[t+2],i[t+3],+i[t],i[t+1],-1,u,l,0,0]):o.push([+i[t],i[t+1],+i[t+2],i[t+3],1,u,l,0,0]),++l;f=tn.min(f,i[1+e]),s=tn.max(s,i[1+e]),++u,l=0}return o.ymin=f,o.ymax=s,o}(p).sort(a)},set:function(n){}}),h.moveTo=function(n,e){n=T([n,e],i);return n&&(p.push(n),m=!1),h},h.closePath=function(){var n,e,t,r;return p.length&&2<p[p.length-1].length&&(n=+p[p.length-1][0],e=p[p.length-1][1],t=+p[p.length-1][p[p.length-1].length-2],r=p[p.length-1][p[p.length-1].length-1],sn(n,t,1e-6)&&sn(e,r,1e-6)||(p[p.length-1].push(n,e),p.push([n,e]),m=!1,y=null)),h},h.lineTo=function(n,e){n=T([n,e],i);return n&&(m?(p.push(n),m=!1):(p[p.length-1].push(n[0],n[1]),y=null)),h},h.rect=function(n,e,t,r){t=T([n,e,n+t,e,n+t,e+r,n,e+r],i);return t&&(t.push(t[0],t[1]),p.length&&p[p.length-1].length<=2?p[p.length-1]=t:p.push(t),p.push([t[0],t[1]]),t[0]=new C(+t[0],{lineCap:"butt",lineJoin:"miter"}),y=null,m=!1),h},h.roundRect=function(n,e,t,r){var u,l,i,o,a,f,s,c=T([n,e,t,r]);return c&&(((s=(arguments[4]&&arguments[4].push?arguments[4]:[].slice.call(arguments,4)).filter(function(n){return 0<n})).length<1||4<s.length)&&R("Invalid radii in roundRect"),a=!1,4===s.length?(u=s[0],l=s[1],i=s[2],o=s[3]):3===s.length?(u=s[0],l=s[1],o=s[1],i=s[2]):o=2===s.length?(u=s[0],i=s[0],l=s[1],s[1]):(u=s[0],l=s[0],i=s[0],s[0]),t<0&&(a=!0,n+=t,t=-t,f=u,u=l,l=f,f=o,o=i,i=f),r<0&&(a=!a,e+=r,r=-r,f=u,u=o,o=f,f=l,l=i,i=f),(s=tn.min(t/(u+l),r/(l+i),t/(i+o),r/(u+o)))<1&&(u*=s,l*=s,o*=s,i*=s),c=[n+u,e],a?(c.push.apply(c,q(n+u,e+u,u,u,0,x,3*v,a)),c.push(n,e+u),c.push.apply(c,q(n+o,e+r-o,o,o,0,v,x,a)),c.push(n+o,e+r),c.push.apply(c,q(n+t-i,e+r-i,i,i,0,0,v,a)),c.push(n+t,e+r-i),c.push.apply(c,q(n+t-l,e+l,l,l,0,3*v,d,a)),c.push(n+t-l,e)):(c.push(n+t-l,e),c.push.apply(c,q(n+t-l,e+l,l,l,0,3*v,d,a)),c.push(n+t,e+r-i),c.push.apply(c,q(n+t-i,e+r-i,i,i,0,0,v,a)),c.push(n+o,e+r),c.push.apply(c,q(n+o,e+r-o,o,o,0,v,x,a)),c.push(n,e+u),c.push.apply(c,q(n+u,e+u,u,u,0,x,3*v,a))),c.push(n+u,e),c[0]=new C(+c[0],{lineCap:"butt",lineJoin:"bevel"}),p.push(c),p.push([n,e]),y=null,m=!1),h},h.arc=function(n,e,t,r,u,l){t<0&&R("Negative radius in arc");n=q(n,e,t,t,0,r,u,l);return n[0]=new C(+n[0],{type:"arc",lineCap:!0,lineJoin:"bevel"}),n[n.length-2]=new C(+n[n.length-2],{type:"arc",lineCap:!0,lineJoin:!0}),m?(p.push(n),m=!1):p[p.length-1].push.apply(p[p.length-1],n),y=null,h},h.ellipse=function(n,e,t,r,u,l,i,o){(t<0||r<0)&&R("Negative radius in ellipse");n=q(n,e,t,r,u,l,i,o);return n[0]=new C(+n[0],{type:"arc",lineCap:!0,lineJoin:"bevel"}),n[n.length-2]=new C(+n[n.length-2],{type:"arc",lineCap:!0,lineJoin:!0}),m?(p.push(n),m=!1):p[p.length-1].push.apply(p[p.length-1],n),y=null,h},h.arcTo=function(n,e,t,r,u){n=T([n,e,t,r],i);return n&&(u<0&&R("Negative radius in arcTo"),m&&(p.push([n[0],n[1]]),m=!1),e=function(n,e,t,r,u,l,i){if(sn(t,n)&&sn(r,e)||sn(t,u)&&sn(r,l)||sn(i,0))return[t,r];var o,a,f,s=!1;if(u={x:u-t,y:l-r},a=fn((l={x:n-t,y:e-r}).x,l.y),f=fn(u.x,u.y),cn(o=(l.x*u.x+l.y*u.y)/(a*f),-1))return[t,r];if(cn(o,1))return[n+(n=65535/a)*l.x,e+n*l.y];e=i/tn.tan(tn.acos(o)/2),o={x:t+(n=e/a)*l.x,y:r+n*l.y},n=fn((a={x:l.y,y:-l.x}).x,a.y),l=i/n,(a.x*u.x+a.y*u.y)/(n*f)<0&&(a={x:-a.x,y:-a.y});l={x:o.x+l*a.x,y:o.y+l*a.y},a={x:-a.x,y:-a.y},n=tn.acos(a.x/n),a.y<0&&(n=d-n);f=fn((e={x:(t={x:t+(a=e/f)*u.x,y:r+a*u.y}).x-l.x,y:t.y-l.y}).x,e.y),r=tn.acos(e.x/f),e.y<0&&(r=d-r);r<n&&n-r<x&&(s=!0);n<r&&x<r-n&&(s=!0);return[o.x,o.y,l.x,l.y,n,r,!(!s||sn(d,i))]}(+p[p.length-1][p[p.length-1].length-2],p[p.length-1][p[p.length-1].length-1],n[0],n[1],n[2],n[3],u),p[p.length-1].push(e[0],e[1]),2<e.length)&&((n=q(e[2],e[3],u,u,0,e[4],e[5],e[6]))[0]=new C(+n[0],{type:"arc",lineCap:!0,lineJoin:"bevel"}),n[n.length-2]=new C(+n[n.length-2],{type:"arc",lineCap:!0,lineJoin:!0}),p[p.length-1].push.apply(p[p.length-1],n)),h},h.quadraticCurveTo=function(n,e,t,r){n=T([n,e,t,r],i);return n&&(m&&(p.push([n[0],n[1]]),m=!1),e=p[p.length-1].pop(),(n=o([+p[p.length-1].pop(),e,n[0],n[1],n[2],n[3]]))[0]=new C(+n[0],{type:"bezier",lineCap:!0,lineJoin:"bevel"}),n[n.length-2]=new C(+n[n.length-2],{type:"bezier",lineCap:!0,lineJoin:!0}),p[p.length-1].push.apply(p[p.length-1],n),y=null),h},h.bezierCurveTo=function(n,e,t,r,u,l){n=T([n,e,t,r,u,l],i);return n&&(m&&(p.push([n[0],n[1]]),m=!1),e=p[p.length-1].pop(),(n=o([+p[p.length-1].pop(),e,n[0],n[1],n[2],n[3],n[4],n[5]]))[0]=new C(+n[0],{type:"bezier",lineCap:!0,lineJoin:"bevel"}),n[n.length-2]=new C(+n[n.length-2],{type:"bezier",lineCap:!0,lineJoin:!0}),p[p.length-1].push.apply(p[p.length-1],n),y=null),h},h.addPath=function(n){return n instanceof N&&(p.push.apply(p,n._d),y=null),h},h.dispose=function(){y=p=null}}function w(n,e,t,r,u,l){var i=this;arguments.length&&(i.m00=n,i.m01=e,i.m02=t,i.m10=r,i.m11=u,i.m12=l)}function C(n,e){this.v=n,this.params=e||null}function T(n,e){for(var t=0,r=n.length;t<r;++t)if(isNaN(n[t])||!isFinite(n[t]))return null;if(e)for(t=0;t<r;t+=2){var u=e.transform(n[t],n[t+1]);n[t]=u[0],n[t+1]=u[1]}return n}function P(L,n,e,N,O,t,F,B,G,U,Y,j){var r,u,l,i,o,M,W,V,H,a,f,K,s,Q,c,h,m,p,y,g,x,d,v,b,w,C,T,P,q,J,X,R,z,D,_,Z,A,S,I,k,E,$=n.length,nn=F,en=t;if($<6)rn(L,u=n[0],l=n[1],i=n[2],o=n[3],a=tn.abs(i-u),f=tn.abs(o-l),(s=un(e,a,f))[0],s[1],t,t,G,U,Y,j);else for($-=2,Q=B*e/2,r=0;r<$;r+=2)u=n[r],l=n[r+1],i=n[r+2],o=n[r+3],s=un(e,a=tn.abs(i-u),f=tn.abs(o-l)),u.params&&u.params.lineCap&&(en=!0===u.params.lineCap?t:u.params.lineCap),rn(L,u,l,i,o,a,f,s[0],s[1],0===r?en:null,$===r+2?en:null,G,U,Y,j),1<e&&0<r&&(u.params&&u.params.lineJoin&&(nn=!0===u.params.lineJoin?F:u.params.lineJoin),c=L,h=M,m=W,p=u,y=l,g=i,x=o,d=V,v=H,b=K[0],w=K[1],C=a,T=f,P=s[0],q=s[1],X=Q,R=G,z=U,D=Y,_=j,E=k=I=S=A=Z=void 0,"bevel"!==(J=nn)&&"miter"!==J||sn(v*C,T*d,1e-4)||(p<h&&g<p&&(E=h,h=g,g=E,E=m,m=x,x=E,E=d,d=C,C=E,E=v,v=T,T=E,E=b,b=P,P=E,E=w,w=q,q=E),w={x:h-(C=(d=p<h?-1:1)*b),y:m+(b=(T=y<m?-1:1)*w)},h={x:h+C,y:m-b},m={x:p-C,y:y+b},C={x:p+C,y:y-b},A={x:p-(P=(b=g<p?-1:1)*P),y:y+(q=(Z=x<y?-1:1)*q)},S={x:p+P,y:y-q},I={x:g-P,y:x+q},g={x:g+P,y:x-q},P={x:p,y:y},x=d==b?T==Z?cn(v,0)?(k=C,S):(k=m,A):(k=m,S):(k=C,A),"bevel"===J?(an(c,k.x,k.y,x.x,x.y,null,null,R,z,D,_),on(c,P.x,P.y,k.x,k.y,x.x,x.y,R,z,D,_)):"miter"===J&&(E=d==b?T==Z?cn(v,0)?ln(h.x,h.y,C.x,C.y,S.x,S.y,g.x,g.y):ln(w.x,w.y,m.x,m.y,A.x,A.y,I.x,I.y):ln(w.x,w.y,m.x,m.y,S.x,S.y,g.x,g.y):ln(h.x,h.y,C.x,C.y,A.x,A.y,I.x,I.y),q=fn(E.x-P.x,E.y-P.y),X<q?(an(c,k.x,k.y,x.x,x.y,null,null,R,z,D,_),on(c,P.x,P.y,k.x,k.y,x.x,x.y,R,z,D,_)):(an(c,k.x,k.y,E.x,E.y,null,null,R,z,D,_),an(c,x.x,x.y,E.x,E.y,null,null,R,z,D,_),on(c,P.x,P.y,k.x,k.y,x.x,x.y,R,z,D,_),on(c,E.x,E.y,k.x,k.y,x.x,x.y,R,z,D,_))))),M=u,W=l,V=a,H=f,K=s}function rn(n,e,t,r,u,l,i,o,a,f,s,c,h,m,p){var y;0===o&&0===a?an(n,e,t,r,u,l,i,c,h,m,p):(n=n,t=t,u=u,i=i,o=o,a=a,f=f,s=s,c=c,h=h,m=m,p=p,(r=r)<(e=e)&&(y=e,e=r,r=y,y=t,t=u,u=y,y=f,f=s,s=y),y=u<t?-1:1,cn(l=l,0)?("square"===f&&(t-=y*o),"square"===s&&(u+=y*o),J(n,tn.round(e-o),tn.round(t),tn.round(e+o),tn.round(u),c,h,m,p)):cn(i,0)?("square"===f&&(e-=+a),"square"===s&&(r+=+a),J(n,tn.round(e),tn.round(t-a),tn.round(r),tn.round(t+a),c,h,m,p)):("square"===f&&(e-=+a,t-=y*o),"square"===s&&(r+=+a,u+=y*o),i=r-(l=+o),s=u+(f=y*a),o=r+l,y=u-f,an(n,a=e-l,r=t+f,u=e+l,e=t-f,null,null,c,h,m,p),an(n,u,e,o,y,null,null,c,h,m,p),an(n,o,y,i,s,null,null,c,h,m,p),an(n,i,s,a,r,null,null,c,h,m,p),on(n,a,r,u,e,i,s,c,h,m,p),on(n,u,e,i,s,o,y,c,h,m,p)))}function un(n,e,t){return n<=1?[0,0]:cn(e,0)?[(n-1)/2,0]:cn(t,0)?[0,(n-1)/2]:[t*(n=(n-1)/2)/(t=fn(e,t)),e*n/t]}function ln(n,e,t,r,u,l,i,o){var a=r-e,f=n-t,t=t*e-n*r,e=o-l,n=u-i,r=i*l-u*o,i=a*n-f*e;return!cn(i,0)&&{x:(f*r-t*n)/i,y:(t*e-a*r)/i}}function J(n,e,t,r,u,l,i,o,a){var f,s;if(r<e&&(f=e,e=r,r=f),u<t&&(s=t,t=u,u=s),null!=l){if(r<l||o<e||u<i||a<t)return;e=tn.max(e,l),t=tn.max(t,i),r=tn.min(r,o),u=tn.min(u,a)}if(t===u)for(f=e;f<=r;++f)n(f,t,1);else if(e===r)for(s=t;s<=u;++s)n(e,s,1);else for(s=t;s<=u;++s)for(f=e;f<=r;++f)n(f,s,1)}function on(n,e,t,r,u,l,i,o,a,f,s){var c,h,m,p,y,g,x,d,v,b,w,C,T,P,q=null!=o;if(!q||!(tn.max(e,r,l)<o||tn.min(e,r,l)>f||tn.max(t,u,i)<a||tn.min(t,u,i)>s)){if(u<t&&(m=t,t=u,u=m,m=e,e=r,r=m),i<t&&(m=t,t=i,i=m,m=e,e=l,l=m),i<u&&(m=u,u=i,i=m,m=r,r=l,l=m),cn(b=i-t,0))return p=tn.round(t),J(n,c=tn.round(tn.min(e,r,l)),p,h=tn.round(tn.max(e,r,l)),p,o,a,f,s);for(C=i-u,x=l-e,d=r-e,v=l-r,T=cn(w=u-t,0),P=cn(C,0),p=tn.round(t+.5),y=u,g=tn.round(i-.5),q&&(p=tn.max(a,p),g=tn.min(s,g));p<=g;++p)if(h=p<y?T?(c=e,r):(c=x*(p-t)/b+e,d*(p-t)/w+e):P?(c=r,l):(c=x*(p-t)/b+e,v*(p-u)/C+r),tn.abs(h-c)<1)(!q||o<=c&&c<=f)&&n(tn.round(c),p,1);else for(h<c&&(m=c,c=h,h=m),c=tn.round(c+.5),h=tn.round(h-.5),q&&(c=tn.max(o,c),h=tn.min(f,h));c<=h;++c)n(c,p,1)}}function an(n,e,t,r,u,l,i,o,a,f,s){var c=tn.min(e,r),h=tn.max(e,r),m=tn.min(t,u),p=tn.max(t,u);if(!(h<o||f<c||p<a||s<m)){if(null==l&&(l=tn.abs(r-e),i=tn.abs(u-t)),c<o||f<h||m<a||s<p){c=function(n,e,t,r,u,l,i,o){var a=-(t=-(t-n)),f=-(r=-(r-e)),u=n-u,i=i-n,l=e-l,o=o-e,s=1,c=0;if(!(0==t&&u<0||0==a&&i<0||0==r&&l<0||0==f&&o<0||(0!=t&&(u=u/t,i=i/a,t<0?(c<u&&(c=u),i<s&&(s=i)):(c<i&&(c=i),u<s&&(s=u))),0!=r&&(t=l/r,i=o/f,r<0?(c<t&&(c=t),i<s&&(s=i)):(c<i&&(c=i),t<s&&(s=t))),s<c)))return[n+a*c,e+f*c,n+a*s,e+f*s]}(e,t,r,u,o,a,f,s);if(!c)return;e=c[0],t=c[1],r=c[2],u=c[3]}if(cn(l,0)||cn(i,0))return J(n,tn.round(e),tn.round(t),tn.round(r),tn.round(u));var y,g,x,d,v=0,b=0,w=0,h=l<i;if(h&&(y=e,e=t,t=y,y=r,r=u,u=y,y=l,l=i,i=y),r<e&&(y=e,e=r,r=y,g=t,t=u,u=g),p=t+(d=(u<t?-1:1)*i/l)*((m=tn.round(e))-e),o=1-(e+.5-tn.floor(e+.5)),a=m,w=1-(b=p-(f=tn.floor(p))),h?(n(f,a,w*o),n(f+1,a,b*o)):(n(a,f,w*o),n(a,f+1,b*o)),v=p+d,p=u+d*((m=tn.round(r))-r),o=r+.5-tn.floor(r+.5),x=m,w=1-(b=p-(s=tn.floor(p))),h?(n(s,x,w*o),n(s+1,x,b*o)):(n(x,s,w*o),n(x,s+1,b*o)),h)for(y=a+1;y<x;++y)0<(w=1-(b=v-(g=tn.floor(v))))&&n(g,y,w),0<b&&n(g+1,y,b),v+=d;else for(y=a+1;y<x;++y)0<(w=1-(b=v-(g=tn.floor(v))))&&n(y,g,w),0<b&&n(y,g+1,b),v+=d}}function q(t,r,u,l,n,i,e,o){var a=e-i,f=(o&&(a=h(a)-d,e=(i=h(i))+a),n?tn.cos(n):1),s=n?tn.sin(n):0,o=c(function(n){var n=i+n*a,e=u*tn.cos(n),n=l*tn.sin(n);return[t+f*e-s*n,r+s*e+f*n]});return!(tn.abs(a)+.001>=d)||sn(o[0],o[o.length-2],.001)&&sn(o[1],o[o.length-1],.001)||o.push(o[0],o[1]),o}function o(i){return c(6<i.length?function(n){var e=1-n,t=n*n,r=e*e,u=r*e,l=t*n,r=3*r*n,n=3*t*e;return[u*i[0]+r*i[2]+n*i[4]+l*i[6],u*i[1]+r*i[3]+n*i[5]+l*i[7]]}:function(n){var e=1-n,t=e*e,e=2*e*n,n=n*n;return[t*i[0]+e*i[2]+n*i[4],t*i[1]+e*i[3]+n*i[5]]})}function O(n,e,t,r,u,l,i,o,a,f,s,c){for(var h,m=0,p=e._d,y=p.length;m<y;++m)(h=p[m])&&2<h.length&&P(n,h,t,0,0,l,i,o,a,f,s,c)}function fn(n,e){n=tn.abs(n),e=tn.abs(e);var t=0;return cn(n,0)?e:cn(e,0)?n:e<n?n*tn.sqrt(1+(t=e/n)*t):n<e?e*tn.sqrt(1+(t=n/e)*t):n*r}function F(n,e,t,r,u,l){return(n-t)*(l-r)-(u-t)*(e-r)<0?-1:1}function m(n,e,t){var r=e[0],e=e[1],u=t[0],t=t[1],l=n[0],n=n[1],u=u-r,t=t-e,i=fn(u,t);return cn(i,0)?fn(l-r,n-e):tn.abs(u*(e-n)-t*(r-l))/i}function B(n,e){for(var t,r,u,l=0,i=0;i<e;++i)if(!(r=n[i])[8])for(t=i+1;t<e;++t)(u=n[t])[8]||r[4]!==u[4]||r[5]!==u[5]||1<tn.abs(r[6]-u[6])||(sn(r[0],u[0],1e-5)&&sn(r[1],u[1],1e-5)&&sn(r[2],u[2],1e-5)&&sn(r[3],u[3],1e-5)||sn(r[3],u[1],1e-6))&&(u[8]=1,++l);return l}function c(n){var e,t=[],r=l,u=n(0);for(t.push(u[0],u[1]),e=0;e<r;++e)u=function n(e,t,r,u,l,i){if(u<=r||sn(r,u,1e-6))return l;l=l||t(r);i=i||t(u);var o,a=fn(i[0]-l[0],i[1]-l[1]);if(a<=f){if(a<1)return l;e.push(i[0],i[1])}else m(o=t(a=(r+u)/2),l,i)<=s?e.push(i[0],i[1]):(n(e,t,r,a,l,o),n(e,t,a,u,o,i));return i}(t,n,0===e?0:e/r,r===e+1?1:(e+1)/r,u,null);return t}function sn(n,e,t){return tn.abs(n-e)<(t||1e-6)}function cn(n,e){return tn.abs(n-e)<Number.EPSILON}function p(n,e,t){return tn.min(tn.max(n,e),t)}function h(n){return n=n,t=0,r=e=d,(n-=e*tn.floor(n/e))<t&&(n+=e),r<n&&(n-=e),n;var e,t,r}function a(n,e){var t=n[1]-e[1];return sn(t,0)?n[3]-e[3]:t}function R(n){throw new Error(n)}return b.VERSION="0.9.6",b[n]={constructor:b,width:null,height:null,getContext:null},b.createImageData=function(n,e){return{data:new t(n*e<<2),width:n,height:e}},b.getRGBAFrom=function(t){var r;return"function"==typeof t?function(n,e){n=t(n,e);return[n[0],n[1],n[2],3<n.length?n[3]/255:1]}:(r=[t[0],t[1],t[2],3<t.length?t[3]:1],function(n,e){return r})},b.setRGBATo=function(o){var c,h,m;return"function"==typeof o?function(n,e,t,r,u,l,i){0<l&&o(n,e,t,r,u,l,i)}:(c=o.width,h=o.height,m=o.data,function(n,e,t,r,u,l,i){var o,a,f,s;0<=n&&n<c&&0<=e&&e<h&&0<l&&(e=m[n=n+c*e<<2],o=m[1+n],a=m[2+n],0<(s=(l=l)+(f=m[3+n]/255)*(1-l)))&&(m[n]=p(tn.round((t*l+e*f*(1-l))/s),0,255),m[1+n]=p(tn.round((r*l+o*f*(1-l))/s),0,255),m[2+n]=p(tn.round((u*l+a*f*(1-l))/s),0,255),m[3+n]=p(tn.round(255*s),0,255))})},u[n]={constructor:u,strokeStyle:null,fillStyle:null,lineWidth:null,lineCap:null,lineJoin:null,miterLimit:null,lineDash:null,lineDashOffset:null,getLineDash:null,setLineDash:null,globalAlpha:null,globalCompositeOperation:null,scale:null,rotate:null,translate:null,transform:null,getTransform:null,setTransform:null,resetTransform:null,beginPath:null,closePath:null,moveTo:null,lineTo:null,rect:null,arc:null,ellipse:null,arcTo:null,quadraticCurveTo:null,bezierCurveTo:null,strokeRect:null,fillRect:null,stroke:null,fill:null,isPointInStroke:null,isPointInPath:null,createImageData:function(n,e){return b.createImageData(n,e)},strokeText:function(){R("Not Implemented!")},fillText:function(){R("Not Implemented!")},measureText:function(){R("Not Implemented!")}},b.RenderingContext2D=u,N[n]={constructor:N,_d:null,_sd:null,dispose:null,addPath:null,moveTo:null,lineTo:null,rect:null,roundRect:null,arc:null,ellipse:null,arcTo:null,quadraticCurveTo:null,bezierCurveTo:null,closePath:null},u.Path2D=N,w[n]={constructor:w,m00:1,m01:0,m02:0,m10:0,m11:1,m12:0,clone:function(){var n=this;return new w(n.m00,n.m01,n.m02,n.m10,n.m11,n.m12)},mul:function(n){var e=this;if(n instanceof w)return new w(e.m00*n.m00+e.m01*n.m10,e.m00*n.m01+e.m01*n.m11,e.m00*n.m02+e.m01*n.m12+e.m02,e.m10*n.m00+e.m11*n.m10,e.m10*n.m01+e.m11*n.m11,e.m10*n.m02+e.m11*n.m12+e.m12)},inv:function(){var n=this,e=n.m00,t=n.m01,r=n.m02,u=n.m10,l=n.m11,n=n.m12,i=e*l-t*u;return cn(i,0)?null:new w(l=l/i,t=-t/i,-l*r-t*n,l=-u/i,t=e/i,-l*r-t*n)},transform:function(n,e){1===arguments.length&&(e=n[1],n=n[0]);var t=this;return[t.m00*n+t.m01*e+t.m02,t.m10*n+t.m11*e+t.m12]}},w.translate=function(n,e){return new w(1,0,n||0,0,1,e||0)},w.scale=function(n,e,t,r){return new w(n,0,-n*(t=t||0)+t,0,e,-e*(r=r||0)+r)},w.rotate=function(n,e,t){e=e||0,t=t||0;var r=tn.cos(n||0),n=tn.sin(n||0);return new w(r,-n,e-r*e+n*t,n,r,t-r*t-n*e)},w.EYE=function(){return new w(1,0,0,0,1,0)},u.Matrix2D=w,C[n]={constructor:C,v:0,params:null,valueOf:function(){return this.v}},b});